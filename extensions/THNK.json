{
  "author": "",
  "category": "Network",
  "extensionNamespace": "",
  "fullName": "THNK framework - Core",
  "helpPath": "https://thnk.cloud/docs/getting-started/",
  "iconUrl": "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMy4wLjMsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iSWNvbnMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMzIgMzIiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMyIDMyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9DQo8L3N0eWxlPg0KPGc+DQoJPHBhdGggZD0iTTI2LDE5Yy0xLjIsMC0yLjMsMC4zLTMuMywxaC00LjRjLTEtMC43LTIuMS0xLTMuMy0xYy0zLjMsMC02LDIuNy02LDZzMi43LDYsNiw2YzEuMiwwLDIuMy0wLjMsMy4zLTFoNC40DQoJCWMxLDAuNywyLjEsMSwzLjMsMWMzLjMsMCw2LTIuNyw2LTZTMjkuMywxOSwyNiwxOXogTTE3LDI2aC0xdjFjMCwwLjYtMC40LDEtMSwxcy0xLTAuNC0xLTF2LTFoLTFjLTAuNiwwLTEtMC40LTEtMXMwLjQtMSwxLTFoMXYtMQ0KCQljMC0wLjYsMC40LTEsMS0xczEsMC40LDEsMXYxaDFjMC42LDAsMSwwLjQsMSwxUzE3LjYsMjYsMTcsMjZ6IE0yNS45LDI2LjRjLTAuMSwwLjEtMC4xLDAuMi0wLjIsMC4zYy0wLjEsMC4xLTAuMiwwLjItMC4zLDAuMg0KCQlTMjUuMSwyNywyNSwyN2MtMC4xLDAtMC4zLDAtMC40LTAuMWMtMC4xLDAtMC4yLTAuMS0wLjMtMC4yYy0wLjEtMC4xLTAuMi0wLjItMC4yLTAuM0MyNCwyNi4zLDI0LDI2LjEsMjQsMjZzMC0wLjMsMC4xLTAuNA0KCQljMC4xLTAuMSwwLjEtMC4yLDAuMi0wLjNjMC4xLTAuMSwwLjItMC4yLDAuMy0wLjJjMC40LTAuMiwwLjgtMC4xLDEuMSwwLjJjMC4xLDAuMSwwLjIsMC4yLDAuMiwwLjNjMCwwLjEsMC4xLDAuMywwLjEsMC40DQoJCVMyNiwyNi4zLDI1LjksMjYuNHogTTI3LjksMjQuNGMtMC4xLDAuMS0wLjEsMC4yLTAuMiwwLjNjLTAuMSwwLjEtMC4yLDAuMi0wLjMsMC4yUzI3LjEsMjUsMjcsMjVjLTAuMSwwLTAuMywwLTAuNC0wLjENCgkJYy0wLjEsMC0wLjItMC4xLTAuMy0wLjJDMjYuMSwyNC41LDI2LDI0LjMsMjYsMjRjMC0wLjMsMC4xLTAuNSwwLjMtMC43YzAsMCwwLjEtMC4xLDAuMS0wLjFjMC4xLDAsMC4xLTAuMSwwLjItMC4xDQoJCWMwLjEsMCwwLjEsMCwwLjItMC4xYzAuMSwwLDAuMywwLDAuNCwwYzAuMSwwLDAuMSwwLDAuMiwwLjFjMC4xLDAsMC4xLDAsMC4yLDAuMWMwLDAsMC4xLDAuMSwwLjEsMC4xYzAuMiwwLjIsMC4zLDAuNSwwLjMsMC43DQoJCUMyOCwyNC4xLDI4LDI0LjMsMjcuOSwyNC40eiIvPg0KCTxwYXRoIGQ9Ik0xMy41LDE3LjJjMC4xLTAuNSwwLjEtMSwwLTEuNWMtMC4yLTEuMi0xLjEtMi4xLTIuMi0yLjVjLTAuNi0wLjItMS4zLTAuNC0yLjEtMC41Yy0yLjQtMC41LTUuMS0xLjEtNi4xLTMuMg0KCQlDMi43LDguNywyLjUsOCwyLjMsNy4zQzAuOSw5LjUsMCwxMi4yLDAsMTVjMCw1LjIsMi45LDkuOCw3LjEsMTIuMmMwLTAuMiwwLjEtMC4zLDAuMS0wLjVDNy4xLDI2LjEsNywyNS42LDcsMjUNCgkJQzcsMjEuMSw5LjgsMTcuOSwxMy41LDE3LjJ6Ii8+DQoJPHBhdGggZD0iTTkuNiwxMC43YzAuOCwwLjIsMS42LDAuNCwyLjMsMC42YzEuOCwwLjYsMy4yLDIuMSwzLjUsNGMwLjEsMC42LDAuMSwxLjIsMCwxLjhjMS4yLDAuMSwyLjMsMC40LDMuMywxaDIuOQ0KCQljMS0wLjcsMS44LTEuNiwyLjQtMi42YzEuNC0yLjEsMS43LTYsMS44LTcuN0MyMy41LDMuNywxOS4xLDEsMTQsMUMxMC4xLDEsNi42LDIuNiw0LDUuMmMwLDAuNSwwLjIsMS45LDAuOSwzLjMNCgkJQzUuNSw5LjgsNy43LDEwLjIsOS42LDEwLjd6Ii8+DQoJPHBhdGggZD0iTTI1LjUsMTdjMC4yLDAsMC4zLDAsMC41LDBjMC42LDAsMS4yLDAuMSwxLjgsMC4yYzAuMS0wLjcsMC4yLTEuNSwwLjItMi4yYzAtMS4yLTAuMi0yLjMtMC40LTMuNA0KCQljLTAuMywxLjctMC44LDMuNi0xLjcsNC45QzI1LjcsMTYuNywyNS42LDE2LjksMjUuNSwxN3oiLz4NCjwvZz4NCjwvc3ZnPg0K",
  "name": "THNK",
  "previewIconUrl": "https://resources.gdevelop-app.com/assets/Icons/Glyphster Pack/Master/SVG/Videogames/Videogames_online_gaming_games_joystick_connect_globe.svg",
  "shortDescription": "A framework to build authoritative multiplayer games.",
  "version": "1.0.0",
  "description": [
    "# The THNK Framework",
    "",
    "A framework for building authoritative games with GDevelop. In a single click, you can turn your THNK game multiplayer!",
    "",
    "Games made with THNK multiplayer will, through a mix of imposed rules and a rich set of optimisations & performant features, run fast as state-of-the-art multiplayer games.",
    "",
    "This - the core THNK extension - allows you to build any game with the authoritative server-client pattern. They will not be multiplayer: by default, all THNK games are single player and will run fine without being connected to anyone else. When/if you want to add multiplayer, THNK servers can be started and connected to in 1 action via the different THNK adapter extensions.",
    "",
    "Learn more at https://thnk.cloud/ ;)"
  ],
  "tags": [
    "multiplayer",
    "arthuro",
    "thnk",
    "thonk",
    "think",
    "server",
    "client",
    "authoritative",
    "easy"
  ],
  "authorIds": [
    "ZgrsWuRTAkXgeuPV9bo0zuEcA2w1"
  ],
  "dependencies": [],
  "eventsFunctions": [
    {
      "fullName": "",
      "functionType": "Action",
      "name": "onFirstSceneLoaded",
      "sentence": "",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "}// Load THNK library (https://github.com/arthuro555/THNK)",
            "window.THNK=(()=>{var ti=Object.defineProperty;var Qa=Object.getOwnPropertyDescriptor;var Ja=Object.getOwnPropertyNames;var tn=Object.prototype.hasOwnProperty;var en=(t,e)=>{for(var i in e)ti(t,i,{get:e[i],enumerable:!0})},sn=(t,e,i,a)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of Ja(e))!tn.call(t,s)&&s!==i&&ti(t,s,{get:()=>e[s],enumerable:!(a=Qa(e,s))||a.enumerable});return t};var an=t=>sn(ti({},\"__esModule\",{value:!0}),t);var Xl={};en(Xl,{ClientAdapter:()=>Yl,ServerAdapter:()=>Gl,client:()=>ua,players:()=>ia,server:()=>Ls,settings:()=>sa});var nn=Object.defineProperty,Ke=(t,e)=>{for(var i in e)nn(t,i,{get:e[i],enumerable:!0})},Ls={};Ke(Ls,{events:()=>Gn,startServer:()=>Yn});var Ct=new Int32Array(2),Zi=new Float32Array(Ct.buffer),Li=new Float64Array(Ct.buffer),Te=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,wi;(function(t){t[t.UTF8_BYTES=1]=\"UTF8_BYTES\",t[t.UTF16_STRING=2]=\"UTF16_STRING\"})(wi||(wi={}));var jt=class{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new jt(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return Ct[0]=this.readInt32(t),Zi[0]}readFloat64(t){return Ct[Te?0:1]=this.readInt32(t),Ct[Te?1:0]=this.readInt32(t+4),Li[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){Zi[0]=e,this.writeInt32(t,Ct[0])}writeFloat64(t,e){Li[0]=e,this.writeInt32(t,Ct[Te?0:1]),this.writeInt32(t+4,Ct[Te?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error(\"FlatBuffers: ByteBuffer is too short to contain an identifier.\");let t=\"\";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){let i=t-this.readInt32(t);return e<this.readInt16(i)?this.readInt16(i+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);let i=this.readInt32(t);t+=4;let a=this.bytes_.subarray(t,t+i);return e===wi.UTF8_BYTES?a:this.text_decoder_.decode(a)}__union_with_string(t,e){return typeof t==\"string\"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error(\"FlatBuffers: file identifier must be length \"+4);for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createScalarList(t,e){let i=[];for(let a=0;a<e;++a)t(a)!==null&&i.push(t(a));return i}createObjList(t,e){let i=[];for(let a=0;a<e;++a){let s=t(a);s!==null&&i.push(s.unpack())}return i}},Bt=class{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let e;t?e=t:e=1024,this.bb=jt.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);let i=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<i+t+e;){let a=this.bb.capacity();this.bb=Bt.growByteBuffer(this.bb),this.space+=this.bb.capacity()-a}this.pad(i)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,i){(this.force_defaults||e!=i)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,i){(this.force_defaults||e!=i)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,i){(this.force_defaults||e!=i)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,i){(this.force_defaults||e!==i)&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,i){(this.force_defaults||e!=i)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,i){e!=i&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error(\"FlatBuffers: struct must be serialized inline.\")}notNested(){if(this.isNested)throw new Error(\"FlatBuffers: object serialization must not be nested.\")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){let e=t.capacity();if(e&3221225472)throw new Error(\"FlatBuffers: cannot grow buffer beyond 2 gigabytes.\");let i=e<<1,a=jt.allocate(i);return a.setPosition(i-e),a.bytes().set(t.bytes(),i-e),a}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error(\"FlatBuffers: endObject called without startObject\");this.addInt32(0);let t=this.offset(),e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);let i=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);let a=2;this.addInt16(t-this.object_start);let s=(i+a)*2;this.addInt16(s);let n=0,r=this.space;t:for(e=0;e<this.vtables.length;e++){let o=this.bb.capacity()-this.vtables[e];if(s==this.bb.readInt16(o)){for(let b=2;b<s;b+=2)if(this.bb.readInt16(r+b)!=this.bb.readInt16(o+b))continue t;n=this.vtables[e];break}}return n?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,n-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,i){let a=i?4:0;if(e){let s=e;if(this.prep(this.minalign,4+4+a),s.length!=4)throw new Error(\"FlatBuffers: file identifier must be length \"+4);for(let n=4-1;n>=0;n--)this.writeInt8(s.charCodeAt(n))}this.prep(this.minalign,4+a),this.addOffset(t),a&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){let i=this.bb.capacity()-t,a=i-this.bb.readInt32(i);if(this.bb.readInt16(a+e)==0)throw new Error(\"FlatBuffers: field \"+e+\" must be set\")}startVector(t,e,i){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(i,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);let e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(t==null)return 0;let e;t instanceof Uint8Array?e=t:e=this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let i=0,a=this.space,s=this.bb.bytes();i<e.length;i++)s[a++]=e[i];return this.endVector()}createObjectOffset(t){return t===null?0:typeof t==\"string\"?this.createString(t):t.pack(this)}createObjectOffsetList(t){let e=[];for(let i=0;i<t.length;++i){let a=t[i];if(a!==null)e.push(this.createObjectOffset(a));else throw new Error(\"FlatBuffers: Argument for createObjectOffsetList cannot contain null.\")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}},mt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsClientInputMessage(t,e){return(e||new mt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsClientInputMessage(t,e){return t.setPosition(t.position()+4),(e||new mt).__init(t.readInt32(t.position())+t.position(),t)}name(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}content(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}contentLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}contentArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startClientInputMessage(t){t.startObject(2)}static addName(t,e){t.addFieldOffset(0,e,0)}static addContent(t,e){t.addFieldOffset(1,e,0)}static createContentVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startContentVector(t,e){t.startVector(1,e,1)}static endClientInputMessage(t){let e=t.endObject();return t.requiredField(e,4),t.requiredField(e,6),e}static createClientInputMessage(t,e,i){return mt.startClientInputMessage(t),mt.addName(t,e),mt.addContent(t,i),mt.endClientInputMessage(t)}},Tt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsConnectionRequestMessage(t,e){return(e||new Tt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsConnectionRequestMessage(t,e){return t.setPosition(t.position()+4),(e||new Tt).__init(t.readInt32(t.position())+t.position(),t)}token(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}static startConnectionRequestMessage(t){t.startObject(1)}static addToken(t,e){t.addFieldOffset(0,e,0)}static endConnectionRequestMessage(t){return t.endObject()}static createConnectionRequestMessage(t,e){return Tt.startConnectionRequestMessage(t),Tt.addToken(t,e),Tt.endConnectionRequestMessage(t)}},vt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsClientMessage(t,e){return(e||new vt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsClientMessage(t,e){return t.setPosition(t.position()+4),(e||new vt).__init(t.readInt32(t.position())+t.position(),t)}contentType(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint8(this.bb_pos+t):0}content(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__union(t,this.bb_pos+e):null}static startClientMessage(t){t.startObject(2)}static addContentType(t,e){t.addFieldInt8(0,e,0)}static addContent(t,e){t.addFieldOffset(1,e,0)}static endClientMessage(t){let e=t.endObject();return t.requiredField(e,6),e}static createClientMessage(t,e,i){return vt.startClientMessage(t),vt.addContentType(t,e),vt.addContent(t,i),vt.endClientMessage(t)}},B=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsVariable(t,e){return(e||new B).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsVariable(t,e){return t.setPosition(t.position()+4),(e||new B).__init(t.readInt32(t.position())+t.position(),t)}type(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint8(this.bb_pos+t):0}text(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}number(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb_pos+t):0}boolean(){let t=this.bb.__offset(this.bb_pos,10);return t?!!this.bb.readInt8(this.bb_pos+t):!1}operations(t,e){let i=this.bb.__offset(this.bb_pos,12);return i?(e||new W).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}operationsLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startVariable(t){t.startObject(5)}static addType(t,e){t.addFieldInt8(0,e,0)}static addText(t,e){t.addFieldOffset(1,e,0)}static addNumber(t,e){t.addFieldFloat32(2,e,0)}static addBoolean(t,e){t.addFieldInt8(3,+e,0)}static addOperations(t,e){t.addFieldOffset(4,e,0)}static createOperationsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startOperationsVector(t,e){t.startVector(4,e,4)}static endVariable(t){return t.endObject()}static createVariable(t,e,i,a,s,n){return B.startVariable(t),B.addType(t,e),B.addText(t,i),B.addNumber(t,a),B.addBoolean(t,s),B.addOperations(t,n),B.endVariable(t)}},W=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCollectionOperation(t,e){return(e||new W).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCollectionOperation(t,e){return t.setPosition(t.position()+4),(e||new W).__init(t.readInt32(t.position())+t.position(),t)}operation(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint8(this.bb_pos+t):0}name(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}index(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint16(this.bb_pos+t):0}val(t){let e=this.bb.__offset(this.bb_pos,10);return e?(t||new B).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startCollectionOperation(t){t.startObject(4)}static addOperation(t,e){t.addFieldInt8(0,e,0)}static addName(t,e){t.addFieldOffset(1,e,0)}static addIndex(t,e){t.addFieldInt16(2,e,0)}static addVal(t,e){t.addFieldOffset(3,e,0)}static endCollectionOperation(t){return t.endObject()}},Ui=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}r(){return this.bb.readUint16(this.bb_pos)}g(){return this.bb.readUint16(this.bb_pos+2)}b(){return this.bb.readUint16(this.bb_pos+4)}static sizeOf(){return 6}static createRGB(t,e,i,a){return t.prep(2,6),t.writeInt16(a),t.writeInt16(i),t.writeInt16(e),t.offset()}},j=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsObjState(t,e){return(e||new j).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsObjState(t,e){return t.setPosition(t.position()+4),(e||new j).__init(t.readInt32(t.position())+t.position(),t)}x(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readFloat32(this.bb_pos+t):null}y(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readFloat32(this.bb_pos+t):null}height(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb_pos+t):null}width(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readFloat32(this.bb_pos+t):null}angle(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readFloat32(this.bb_pos+t):null}scale(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readFloat32(this.bb_pos+t):null}tint(t){let e=this.bb.__offset(this.bb_pos,16);return e?(t||new Ui).__init(this.bb_pos+e,this.bb):null}setXTo0(){let t=this.bb.__offset(this.bb_pos,18);return t?!!this.bb.readInt8(this.bb_pos+t):!1}setYTo0(){let t=this.bb.__offset(this.bb_pos,20);return t?!!this.bb.readInt8(this.bb_pos+t):!1}setHeightTo0(){let t=this.bb.__offset(this.bb_pos,22);return t?!!this.bb.readInt8(this.bb_pos+t):!1}setWidthTo0(){let t=this.bb.__offset(this.bb_pos,24);return t?!!this.bb.readInt8(this.bb_pos+t):!1}setAngleTo0(){let t=this.bb.__offset(this.bb_pos,26);return t?!!this.bb.readInt8(this.bb_pos+t):!1}setScaleTo0(){let t=this.bb.__offset(this.bb_pos,28);return t?!!this.bb.readInt8(this.bb_pos+t):!1}zOrder(){let t=this.bb.__offset(this.bb_pos,30);return t?this.bb.readUint16(this.bb_pos+t):null}bigZOrder(){let t=this.bb.__offset(this.bb_pos,32);return t?this.bb.readUint32(this.bb_pos+t):null}visible(){let t=this.bb.__offset(this.bb_pos,34);return t?this.bb.readUint8(this.bb_pos+t):null}flippedX(){let t=this.bb.__offset(this.bb_pos,36);return t?this.bb.readUint8(this.bb_pos+t):null}flippedY(){let t=this.bb.__offset(this.bb_pos,38);return t?this.bb.readUint8(this.bb_pos+t):null}opacity(){let t=this.bb.__offset(this.bb_pos,40);return t?this.bb.readUint8(this.bb_pos+t):null}setOpacityTo0(){let t=this.bb.__offset(this.bb_pos,42);return t?!!this.bb.readInt8(this.bb_pos+t):!1}animation(){let t=this.bb.__offset(this.bb_pos,44);return t?this.bb.readUint8(this.bb_pos+t):null}text(t){let e=this.bb.__offset(this.bb_pos,46);return e?this.bb.__string(this.bb_pos+e,t):null}static startObjState(t){t.startObject(22)}static addX(t,e){t.addFieldFloat32(0,e,0)}static addY(t,e){t.addFieldFloat32(1,e,0)}static addHeight(t,e){t.addFieldFloat32(2,e,0)}static addWidth(t,e){t.addFieldFloat32(3,e,0)}static addAngle(t,e){t.addFieldFloat32(4,e,0)}static addScale(t,e){t.addFieldFloat32(5,e,0)}static addTint(t,e){t.addFieldStruct(6,e,0)}static addSetXTo0(t,e){t.addFieldInt8(7,+e,0)}static addSetYTo0(t,e){t.addFieldInt8(8,+e,0)}static addSetHeightTo0(t,e){t.addFieldInt8(9,+e,0)}static addSetWidthTo0(t,e){t.addFieldInt8(10,+e,0)}static addSetAngleTo0(t,e){t.addFieldInt8(11,+e,0)}static addSetScaleTo0(t,e){t.addFieldInt8(12,+e,0)}static addZOrder(t,e){t.addFieldInt16(13,e,0)}static addBigZOrder(t,e){t.addFieldInt32(14,e,0)}static addVisible(t,e){t.addFieldInt8(15,e,0)}static addFlippedX(t,e){t.addFieldInt8(16,e,0)}static addFlippedY(t,e){t.addFieldInt8(17,e,0)}static addOpacity(t,e){t.addFieldInt8(18,e,0)}static addSetOpacityTo0(t,e){t.addFieldInt8(19,+e,0)}static addAnimation(t,e){t.addFieldInt8(20,e,0)}static addText(t,e){t.addFieldOffset(21,e,0)}static endObjState(t){return t.endObject()}},G=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsGameObject(t,e){return(e||new G).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGameObject(t,e){return t.setPosition(t.position()+4),(e||new G).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint16(this.bb_pos+t):0}name(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}objState(t){let e=this.bb.__offset(this.bb_pos,8);return e?(t||new j).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}publicStateDiff(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}publicStateDiffLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}publicStateDiffArray(){let t=this.bb.__offset(this.bb_pos,10);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}privateStateDiff(t){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}privateStateDiffLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}privateStateDiffArray(){let t=this.bb.__offset(this.bb_pos,12);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}packedPublicState(t){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}packedPublicStateLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}packedPublicStateArray(){let t=this.bb.__offset(this.bb_pos,14);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}packedPrivateState(t){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}packedPrivateStateLength(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}packedPrivateStateArray(){let t=this.bb.__offset(this.bb_pos,16);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startGameObject(t){t.startObject(7)}static addId(t,e){t.addFieldInt16(0,e,0)}static addName(t,e){t.addFieldOffset(1,e,0)}static addObjState(t,e){t.addFieldOffset(2,e,0)}static addPublicStateDiff(t,e){t.addFieldOffset(3,e,0)}static createPublicStateDiffVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startPublicStateDiffVector(t,e){t.startVector(1,e,1)}static addPrivateStateDiff(t,e){t.addFieldOffset(4,e,0)}static createPrivateStateDiffVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startPrivateStateDiffVector(t,e){t.startVector(1,e,1)}static addPackedPublicState(t,e){t.addFieldOffset(5,e,0)}static createPackedPublicStateVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startPackedPublicStateVector(t,e){t.startVector(1,e,1)}static addPackedPrivateState(t,e){t.addFieldOffset(6,e,0)}static createPackedPrivateStateVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startPackedPrivateStateVector(t,e){t.startVector(1,e,1)}static endGameObject(t){return t.endObject()}},Q=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsGameStateSnapshot(t,e){return(e||new Q).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGameStateSnapshot(t,e){return t.setPosition(t.position()+4),(e||new Q).__init(t.readInt32(t.position())+t.position(),t)}objects(t,e){let i=this.bb.__offset(this.bb_pos,4);return i?(e||new G).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}objectsLength(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}publicStatePacked(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}publicStatePackedLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}publicStatePackedArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}privateStatePacked(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}privateStatePackedLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}privateStatePackedArray(){let t=this.bb.__offset(this.bb_pos,8);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startGameStateSnapshot(t){t.startObject(3)}static addObjects(t,e){t.addFieldOffset(0,e,0)}static createObjectsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startObjectsVector(t,e){t.startVector(4,e,4)}static addPublicStatePacked(t,e){t.addFieldOffset(1,e,0)}static createPublicStatePackedVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startPublicStatePackedVector(t,e){t.startVector(1,e,1)}static addPrivateStatePacked(t,e){t.addFieldOffset(2,e,0)}static createPrivateStatePackedVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startPrivateStatePackedVector(t,e){t.startVector(1,e,1)}static endGameStateSnapshot(t){return t.endObject()}static createGameStateSnapshot(t,e,i,a){return Q.startGameStateSnapshot(t),Q.addObjects(t,e),Q.addPublicStatePacked(t,i),Q.addPrivateStatePacked(t,a),Q.endGameStateSnapshot(t)}},Zt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsConnectionStartMessage(t,e){return(e||new Zt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsConnectionStartMessage(t,e){return t.setPosition(t.position()+4),(e||new Zt).__init(t.readInt32(t.position())+t.position(),t)}sceneName(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}sceneSnapshot(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new Q).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startConnectionStartMessage(t){t.startObject(2)}static addSceneName(t,e){t.addFieldOffset(0,e,0)}static addSceneSnapshot(t,e){t.addFieldOffset(1,e,0)}static endConnectionStartMessage(t){let e=t.endObject();return t.requiredField(e,4),t.requiredField(e,6),e}},Ut=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCreatedObject(t,e){return(e||new Ut).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCreatedObject(t,e){return t.setPosition(t.position()+4),(e||new Ut).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint16(this.bb_pos+t):0}name(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startCreatedObject(t){t.startObject(2)}static addId(t,e){t.addFieldInt16(0,e,0)}static addName(t,e){t.addFieldOffset(1,e,0)}static endCreatedObject(t){let e=t.endObject();return t.requiredField(e,6),e}static createCreatedObject(t,e,i){return Ut.startCreatedObject(t),Ut.addId(t,e),Ut.addName(t,i),Ut.endCreatedObject(t)}},Y=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsScene(t,e){return(e||new Y).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsScene(t,e){return t.setPosition(t.position()+4),(e||new Y).__init(t.readInt32(t.position())+t.position(),t)}publicStateDiff(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}publicStateDiffLength(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}publicStateDiffArray(){let t=this.bb.__offset(this.bb_pos,4);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}privateStateDiff(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}privateStateDiffLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}privateStateDiffArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}objects(t,e){let i=this.bb.__offset(this.bb_pos,8);return i?(e||new G).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}objectsLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}createdObjects(t,e){let i=this.bb.__offset(this.bb_pos,10);return i?(e||new Ut).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}createdObjectsLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}deletedObjects(t){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint16(this.bb.__vector(this.bb_pos+e)+t*2):0}deletedObjectsLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}deletedObjectsArray(){let t=this.bb.__offset(this.bb_pos,12);return t?new Uint16Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startScene(t){t.startObject(5)}static addPublicStateDiff(t,e){t.addFieldOffset(0,e,0)}static createPublicStateDiffVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startPublicStateDiffVector(t,e){t.startVector(1,e,1)}static addPrivateStateDiff(t,e){t.addFieldOffset(1,e,0)}static createPrivateStateDiffVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startPrivateStateDiffVector(t,e){t.startVector(1,e,1)}static addObjects(t,e){t.addFieldOffset(2,e,0)}static createObjectsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startObjectsVector(t,e){t.startVector(4,e,4)}static addCreatedObjects(t,e){t.addFieldOffset(3,e,0)}static createCreatedObjectsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCreatedObjectsVector(t,e){t.startVector(4,e,4)}static addDeletedObjects(t,e){t.addFieldOffset(4,e,0)}static createDeletedObjectsVector(t,e){t.startVector(2,e.length,2);for(let i=e.length-1;i>=0;i--)t.addInt16(e[i]);return t.endVector()}static startDeletedObjectsVector(t,e){t.startVector(2,e,2)}static endScene(t){return t.endObject()}static createScene(t,e,i,a,s,n){return Y.startScene(t),Y.addPublicStateDiff(t,e),Y.addPrivateStateDiff(t,i),Y.addObjects(t,a),Y.addCreatedObjects(t,s),Y.addDeletedObjects(t,n),Y.endScene(t)}},Ot=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsGameStateUpdateMessage(t,e){return(e||new Ot).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGameStateUpdateMessage(t,e){return t.setPosition(t.position()+4),(e||new Ot).__init(t.readInt32(t.position())+t.position(),t)}scene(t){let e=this.bb.__offset(this.bb_pos,4);return e?(t||new Y).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startGameStateUpdateMessage(t){t.startObject(1)}static addScene(t,e){t.addFieldOffset(0,e,0)}static endGameStateUpdateMessage(t){return t.endObject()}static createGameStateUpdateMessage(t,e){return Ot.startGameStateUpdateMessage(t),Ot.addScene(t,e),Ot.endGameStateUpdateMessage(t)}},ht=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsResumePreviousSceneMessage(t,e){return(e||new ht).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsResumePreviousSceneMessage(t,e){return t.setPosition(t.position()+4),(e||new ht).__init(t.readInt32(t.position())+t.position(),t)}snapshot(t){let e=this.bb.__offset(this.bb_pos,4);return e?(t||new Q).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}name(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startResumePreviousSceneMessage(t){t.startObject(2)}static addSnapshot(t,e){t.addFieldOffset(0,e,0)}static addName(t,e){t.addFieldOffset(1,e,0)}static endResumePreviousSceneMessage(t){return t.endObject()}static createResumePreviousSceneMessage(t,e,i){return ht.startResumePreviousSceneMessage(t),ht.addSnapshot(t,e),ht.addName(t,i),ht.endResumePreviousSceneMessage(t)}},dt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSceneSwitchMessage(t,e){return(e||new dt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSceneSwitchMessage(t,e){return t.setPosition(t.position()+4),(e||new dt).__init(t.readInt32(t.position())+t.position(),t)}sceneName(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}isPause(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startSceneSwitchMessage(t){t.startObject(2)}static addSceneName(t,e){t.addFieldOffset(0,e,0)}static addIsPause(t,e){t.addFieldInt8(1,+e,0)}static endSceneSwitchMessage(t){let e=t.endObject();return t.requiredField(e,4),e}static createSceneSwitchMessage(t,e,i){return dt.startSceneSwitchMessage(t),dt.addSceneName(t,e),dt.addIsPause(t,i),dt.endSceneSwitchMessage(t)}},ct=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsServerMessage(t,e){return(e||new ct).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsServerMessage(t,e){return t.setPosition(t.position()+4),(e||new ct).__init(t.readInt32(t.position())+t.position(),t)}contentType(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint8(this.bb_pos+t):0}content(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__union(t,this.bb_pos+e):null}static startServerMessage(t){t.startObject(2)}static addContentType(t,e){t.addFieldInt8(0,e,0)}static addContent(t,e){t.addFieldOffset(1,e,0)}static endServerMessage(t){let e=t.endObject();return t.requiredField(e,6),e}static createServerMessage(t,e,i){return ct.startServerMessage(t),ct.addContentType(t,e),ct.addContent(t,i),ct.endServerMessage(t)}},yi;try{yi=new TextDecoder}catch{}var v,At,d=0,nt={},M,Ft,lt=0,pt=0,J,It,ot=[],z,Hi={useRecords:!1,mapsAsObjects:!0},Hs=class{},Ys=new Hs;Ys.name=\"MessagePack 0xC1\";var ee=!1,Gs=2;try{new Function(\"\")}catch{Gs=1/0}var He=class{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.sequential&&t.trusted!==!1&&(t.trusted=!0,!t.structures&&t.useRecords!=!1&&(t.structures=[],t.maxSharedStructures||(t.maxSharedStructures=0))),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(v)return $s(()=>(vi(),this?this.unpack(t,e):He.prototype.unpack.call(Hi,t,e)));At=e>-1?e:t.length,d=0,pt=0,Ft=null,J=null,v=t;try{z=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(i){throw v=null,t instanceof Uint8Array?i:new Error(\"Source must be a Uint8Array or Buffer but was a \"+(t&&typeof t==\"object\"?t.constructor.name:typeof t))}if(this instanceof He){if(nt=this,this.structures)return M=this.structures,Ve();(!M||M.length>0)&&(M=[])}else nt=Hi,(!M||M.length>0)&&(M=[]);return Ve()}unpackMultiple(t,e){let i,a=0;try{ee=!0;let s=t.length,n=this?this.unpack(t,s):Qs.unpack(t,s);if(e){for(e(n);d<s;)if(a=d,e(Ve())===!1)return}else{for(i=[n];d<s;)a=d,i.push(Ve());return i}}catch(s){throw s.lastPosition=a,s.values=i,s}finally{ee=!1,vi()}}_mergeStructures(t,e){t=t||[];for(let i=0,a=t.length;i<a;i++){let s=t[i];s&&(s.isShared=!0,i>=32&&(s.highByte=i-32>>5))}t.sharedLength=t.length;for(let i in e||[])if(i>=0){let a=t[i],s=e[i];s&&(a&&((t.restoreStructures||(t.restoreStructures=[]))[i]=a),t[i]=s)}return this.structures=t}decode(t,e){return this.unpack(t,e)}};function Ve(){try{if(!nt.trusted&&!ee){let e=M.sharedLength||0;e<M.length&&(M.length=e)}let t=X();if(J&&(d=J.postBundlePosition),d==At)M.restoreStructures&&Yi(),M=null,v=null,It&&(It=null);else{if(d>At)throw new Error(\"Unexpected end of MessagePack data\");if(!ee)throw new Error(\"Data read, but end of buffer not reached \"+JSON.stringify(t).slice(0,100))}return t}catch(t){throw M.restoreStructures&&Yi(),vi(),(t instanceof RangeError||t.message.startsWith(\"Unexpected end of buffer\")||d>At)&&(t.incomplete=!0),t}}function Yi(){for(let t in M.restoreStructures)M[t]=M.restoreStructures[t];M.restoreStructures=null}function X(){let t=v[d++];if(t<160)if(t<128){if(t<64)return t;{let e=M[t&63]||nt.getStructures&&Xs()[t&63];return e?(e.read||(e.read=Ti(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,nt.mapsAsObjects){let e={};for(let i=0;i<t;i++){let a=Ks();a===\"__proto__\"&&(a=\"__proto_\"),e[a]=X()}return e}else{let e=new Map;for(let i=0;i<t;i++)e.set(X(),X());return e}else{t-=144;let e=new Array(t);for(let i=0;i<t;i++)e[i]=X();return e}else if(t<192){let e=t-160;if(pt>=d)return Ft.slice(d-lt,(d+=e)-lt);if(pt==0&&At<140){let i=e<16?Vi(e):Ws(e);if(i!=null)return i}return mi(e)}else{let e;switch(t){case 192:return null;case 193:return J?(e=X(),e>0?J[1].slice(J.position1,J.position1+=e):J[0].slice(J.position0,J.position0-=e)):Ys;case 194:return!1;case 195:return!0;case 196:if(e=v[d++],e===void 0)throw new Error(\"Unexpected end of buffer\");return ei(e);case 197:return e=z.getUint16(d),d+=2,ei(e);case 198:return e=z.getUint32(d),d+=4,ei(e);case 199:return Nt(v[d++]);case 200:return e=z.getUint16(d),d+=2,Nt(e);case 201:return e=z.getUint32(d),d+=4,Nt(e);case 202:if(e=z.getFloat32(d),nt.useFloat32>2){let i=Fi[(v[d]&127)<<1|v[d+1]>>7];return d+=4,(i*e+(e>0?.5:-.5)>>0)/i}return d+=4,e;case 203:return e=z.getFloat64(d),d+=8,e;case 204:return v[d++];case 205:return e=z.getUint16(d),d+=2,e;case 206:return e=z.getUint32(d),d+=4,e;case 207:return nt.int64AsNumber?(e=z.getUint32(d)*4294967296,e+=z.getUint32(d+4)):e=z.getBigUint64(d),d+=8,e;case 208:return z.getInt8(d++);case 209:return e=z.getInt16(d),d+=2,e;case 210:return e=z.getInt32(d),d+=4,e;case 211:return nt.int64AsNumber?(e=z.getInt32(d)*4294967296,e+=z.getUint32(d+4)):e=z.getBigInt64(d),d+=8,e;case 212:if(e=v[d++],e==114)return $i(v[d++]&63);{let i=ot[e];if(i)return i.read?(d++,i.read(X())):i.noBuffer?(d++,i()):i(v.subarray(d,++d));throw new Error(\"Unknown extension \"+e)}case 213:return e=v[d],e==114?(d++,$i(v[d++]&63,v[d++])):Nt(2);case 214:return Nt(4);case 215:return Nt(8);case 216:return Nt(16);case 217:return e=v[d++],pt>=d?Ft.slice(d-lt,(d+=e)-lt):on(e);case 218:return e=z.getUint16(d),d+=2,pt>=d?Ft.slice(d-lt,(d+=e)-lt):ln(e);case 219:return e=z.getUint32(d),d+=4,pt>=d?Ft.slice(d-lt,(d+=e)-lt):hn(e);case 220:return e=z.getUint16(d),d+=2,Xi(e);case 221:return e=z.getUint32(d),d+=4,Xi(e);case 222:return e=z.getUint16(d),d+=2,Wi(e);case 223:return e=z.getUint32(d),d+=4,Wi(e);default:if(t>=224)return t-256;if(t===void 0){let i=new Error(\"Unexpected end of MessagePack data\");throw i.incomplete=!0,i}throw new Error(\"Unknown MessagePack token \"+t)}}}var rn=/^[a-zA-Z_$][a-zA-Z\\d_$]*$/;function Ti(t,e){function i(){if(i.count++>Gs){let s=t.read=new Function(\"r\",\"return function(){return {\"+t.map(n=>n===\"__proto__\"?\"__proto_:r()\":rn.test(n)?n+\":r()\":\"[\"+JSON.stringify(n)+\"]:r()\").join(\",\")+\"}}\")(X);return t.highByte===0&&(t.read=Gi(e,t.read)),s()}let a={};for(let s=0,n=t.length;s<n;s++){let r=t[s];r===\"__proto__\"&&(r=\"__proto_\"),a[r]=X()}return a}return i.count=0,t.highByte===0?Gi(e,i):i}var Gi=(t,e)=>function(){let i=v[d++];if(i===0)return e();let a=t<32?-(t+(i<<5)):t+(i<<5),s=M[a]||Xs()[a];if(!s)throw new Error(\"Record id is not defined for \"+a);return s.read||(s.read=Ti(s,t)),s.read()};function Xs(){let t=$s(()=>(v=null,nt.getStructures()));return M=nt._mergeStructures(t,M)}var mi=Ie,on=Ie,ln=Ie,hn=Ie;function Ie(t){let e;if(t<16&&(e=Vi(t)))return e;if(t>64&&yi)return yi.decode(v.subarray(d,d+=t));let i=d+t,a=[];for(e=\"\";d<i;){let s=v[d++];if((s&128)===0)a.push(s);else if((s&224)===192){let n=v[d++]&63;a.push((s&31)<<6|n)}else if((s&240)===224){let n=v[d++]&63,r=v[d++]&63;a.push((s&31)<<12|n<<6|r)}else if((s&248)===240){let n=v[d++]&63,r=v[d++]&63,o=v[d++]&63,b=(s&7)<<18|n<<12|r<<6|o;b>65535&&(b-=65536,a.push(b>>>10&1023|55296),b=56320|b&1023),a.push(b)}else a.push(s);a.length>=4096&&(e+=q.apply(String,a),a.length=0)}return a.length>0&&(e+=q.apply(String,a)),e}function Xi(t){let e=new Array(t);for(let i=0;i<t;i++)e[i]=X();return e}function Wi(t){if(nt.mapsAsObjects){let e={};for(let i=0;i<t;i++){let a=Ks();a===\"__proto__\"&&(a=\"__proto_\"),e[a]=X()}return e}else{let e=new Map;for(let i=0;i<t;i++)e.set(X(),X());return e}}var q=String.fromCharCode;function Ws(t){let e=d,i=new Array(t);for(let a=0;a<t;a++){let s=v[d++];if((s&128)>0){d=e;return}i[a]=s}return q.apply(String,i)}function Vi(t){if(t<4)if(t<2){if(t===0)return\"\";{let e=v[d++];if((e&128)>1){d-=1;return}return q(e)}}else{let e=v[d++],i=v[d++];if((e&128)>0||(i&128)>0){d-=2;return}if(t<3)return q(e,i);let a=v[d++];if((a&128)>0){d-=3;return}return q(e,i,a)}else{let e=v[d++],i=v[d++],a=v[d++],s=v[d++];if((e&128)>0||(i&128)>0||(a&128)>0||(s&128)>0){d-=4;return}if(t<6){if(t===4)return q(e,i,a,s);{let n=v[d++];if((n&128)>0){d-=5;return}return q(e,i,a,s,n)}}else if(t<8){let n=v[d++],r=v[d++];if((n&128)>0||(r&128)>0){d-=6;return}if(t<7)return q(e,i,a,s,n,r);let o=v[d++];if((o&128)>0){d-=7;return}return q(e,i,a,s,n,r,o)}else{let n=v[d++],r=v[d++],o=v[d++],b=v[d++];if((n&128)>0||(r&128)>0||(o&128)>0||(b&128)>0){d-=8;return}if(t<10){if(t===8)return q(e,i,a,s,n,r,o,b);{let l=v[d++];if((l&128)>0){d-=9;return}return q(e,i,a,s,n,r,o,b,l)}}else if(t<12){let l=v[d++],h=v[d++];if((l&128)>0||(h&128)>0){d-=10;return}if(t<11)return q(e,i,a,s,n,r,o,b,l,h);let O=v[d++];if((O&128)>0){d-=11;return}return q(e,i,a,s,n,r,o,b,l,h,O)}else{let l=v[d++],h=v[d++],O=v[d++],w=v[d++];if((l&128)>0||(h&128)>0||(O&128)>0||(w&128)>0){d-=12;return}if(t<14){if(t===12)return q(e,i,a,s,n,r,o,b,l,h,O,w);{let _=v[d++];if((_&128)>0){d-=13;return}return q(e,i,a,s,n,r,o,b,l,h,O,w,_)}}else{let _=v[d++],V=v[d++];if((_&128)>0||(V&128)>0){d-=14;return}if(t<15)return q(e,i,a,s,n,r,o,b,l,h,O,w,_,V);let U=v[d++];if((U&128)>0){d-=15;return}return q(e,i,a,s,n,r,o,b,l,h,O,w,_,V,U)}}}}}function Ki(){let t=v[d++],e;if(t<192)e=t-160;else switch(t){case 217:e=v[d++];break;case 218:e=z.getUint16(d),d+=2;break;case 219:e=z.getUint32(d),d+=4;break;default:throw new Error(\"Expected string\")}return Ie(e)}function ei(t){return nt.copyBuffers?Uint8Array.prototype.slice.call(v,d,d+=t):v.subarray(d,d+=t)}function Nt(t){let e=v[d++];if(ot[e])return ot[e](v.subarray(d,d+=t));throw new Error(\"Unknown extension type \"+e)}var qi=new Array(4096);function Ks(){let t=v[d++];if(t>=160&&t<192){if(t=t-160,pt>=d)return Ft.slice(d-lt,(d+=t)-lt);if(!(pt==0&&At<180))return mi(t)}else return d--,X();let e=(t<<5^(t>1?z.getUint16(d):t>0?v[d]:0))&4095,i=qi[e],a=d,s=d+t-3,n,r=0;if(i&&i.bytes==t){for(;a<s;){if(n=z.getUint32(a),n!=i[r++]){a=1879048192;break}a+=4}for(s+=3;a<s;)if(n=v[a++],n!=i[r++]){a=1879048192;break}if(a===s)return d=a,i.string;s-=3,a=d}for(i=[],qi[e]=i,i.bytes=t;a<s;)n=z.getUint32(a),i.push(n),a+=4;for(s+=3;a<s;)n=v[a++],i.push(n);let o=t<16?Vi(t):Ws(t);return o!=null?i.string=o:i.string=mi(t)}var $i=(t,e)=>{var i=X();let a=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,i.highByte=e);let s=M[t];return s&&s.isShared&&((M.restoreStructures||(M.restoreStructures=[]))[t]=s),M[t]=i,i.read=Ti(i,a),i.read()};ot[0]=()=>{};ot[0].noBuffer=!0;ot[101]=()=>{let t=X();return(globalThis[t[0]]||Error)(t[1])};ot[105]=t=>{let e=z.getUint32(d-4);It||(It=new Map);let i=v[d],a;i>=144&&i<160||i==220||i==221?a=[]:a={};let s={target:a};It.set(e,s);let n=X();return s.used?Object.assign(a,n):(s.target=n,n)};ot[112]=t=>{let e=z.getUint32(d-4),i=It.get(e);return i.used=!0,i.target};ot[115]=()=>new Set(X());var qs=[\"Int8\",\"Uint8\",\"Uint8Clamped\",\"Int16\",\"Uint16\",\"Int32\",\"Uint32\",\"Float32\",\"Float64\",\"BigInt64\",\"BigUint64\"].map(t=>t+\"Array\");ot[116]=t=>{let e=t[0],i=qs[e];if(!i)throw new Error(\"Could not find typed array for code \"+e);return new globalThis[i](Uint8Array.prototype.slice.call(t,1).buffer)};ot[120]=()=>{let t=X();return new RegExp(t[0],t[1])};var dn=[];ot[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],i=d;return d+=e-t.length,J=dn,J=[Ki(),Ki()],J.position0=0,J.position1=0,J.postBundlePosition=d,d=i,X()};ot[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date(\"invalid\");function $s(t){let e=At,i=d,a=lt,s=pt,n=Ft,r=It,o=J,b=new Uint8Array(v.slice(0,At)),l=M,h=M.slice(0,M.length),O=nt,w=ee,_=t();return At=e,d=i,lt=a,pt=s,Ft=n,It=r,J=o,v=b,ee=w,M=l,M.splice(0,M.length,...h),nt=O,z=new DataView(v.buffer,v.byteOffset,v.byteLength),_}function vi(){v=null,It=null,M=null}var Fi=new Array(147);for(let t=0;t<256;t++)Fi[t]=+(\"1e\"+Math.floor(45.15-t*.30103));var Qs=new He({useRecords:!1}),cn=Qs.unpack,Be;try{Be=new TextEncoder}catch{}var Si,Js,qe=typeof Buffer<\"u\",Fe=qe?function(t){return Buffer.allocUnsafeSlow(t)}:Uint8Array,ta=qe?Buffer:Uint8Array,Qi=qe?4294967296:2144337920,f,oe,H,c=0,it,K=null,bn=61440,un=/[\\u0080-\\uFFFF]/,qt=Symbol(\"record-id\"),fn=class extends He{constructor(t){super(t),this.offset=0;let e,i,a,s,n=0,r=ta.prototype.utf8Write?function(u,S){return f.utf8Write(u,S,4294967295)}:Be&&Be.encodeInto?function(u,S){return Be.encodeInto(u,f.subarray(S)).written}:!1,o=this;t||(t={});let b=t&&t.sequential,l=t.structures||t.saveStructures,h=t.maxSharedStructures;if(h==null&&(h=l?32:0),h>8160)throw new Error(\"Maximum maxSharedStructure is 8160\");t.structuredClone&&t.moreTypes==null&&(t.moreTypes=!0);let O=t.maxOwnStructures;O==null&&(O=l?32:64),!this.structures&&t.useRecords!=!1&&(this.structures=[]);let w=h>32||O+h>64,_=h+64,V=h+O+64;if(V>8256)throw new Error(\"Maximum maxSharedStructure + maxOwnStructure is 8192\");let U=[],x=0,I=0;this.pack=this.encode=function(u,S){if(f||(f=new Fe(8192),H=new DataView(f.buffer,0,8192),c=0),it=f.length-10,it-c<2048?(f=new Fe(f.length),H=new DataView(f.buffer,0,f.length),it=f.length-10,c=0):c=c+7&2147483640,e=c,s=o.structuredClone?new Map:null,o.bundleStrings&&typeof u!=\"string\"?(K=[],K.size=1/0):K=null,a=o.structures,a){a.uninitialized&&(a=o._mergeStructures(o.getStructures()));let p=a.sharedLength||0;if(p>h)throw new Error(\"Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to \"+a.sharedLength);if(!a.transitions){a.transitions=Object.create(null);for(let g=0;g<p;g++){let y=a[g];if(!y)continue;let R,T=a.transitions;for(let C=0,L=y.length;C<L;C++){let E=y[C];R=T[E],R||(R=T[E]=Object.create(null)),T=R}T[qt]=g+64}n=p}b||(a.nextId=p+64)}i&&(i=!1);try{if(k(u),K&&es(e,k),o.offset=c,s&&s.idsToInsert){c+=s.idsToInsert.length*6,c>it&&A(c),o.offset=c;let p=pn(f.subarray(e,c),s.idsToInsert);return s=null,p}return S&yn?(f.start=e,f.end=c,f):f.subarray(e,c)}finally{if(a){I<10&&I++;let p=a.sharedLength||h;if(a.length>p&&(a.length=p),x>1e4)a.transitions=null,I=0,x=0,U.length>0&&(U=[]);else if(U.length>0&&!b){for(let g=0,y=U.length;g<y;g++)U[g][qt]=0;U=[]}if(i&&o.saveStructures){let g=f.subarray(e,c);return o.saveStructures(a,n)===!1?(o._mergeStructures(o.getStructures()),o.pack(u)):(n=p,g)}}S&mn&&(c=e)}};let k=u=>{c>it&&(f=A(c));var S=typeof u,p;if(S===\"string\"){let g=u.length;if(K&&g>=4&&g<4096){if((K.size+=g)>bn){let C,L=(K[0]?K[0].length*3+K[1].length:0)+10;c+L>it&&(f=A(c+L)),K.position?(f[c]=200,c+=3,f[c++]=98,C=c-e,c+=4,es(e,k),H.setUint16(C+e-3,c-e-C)):(f[c++]=214,f[c++]=98,C=c-e,c+=4),K=[\"\",\"\"],K.size=0,K.position=C}let T=un.test(u);K[T?0:1]+=u,f[c++]=193,k(T?-g:g);return}let y;g<32?y=1:g<256?y=2:g<65536?y=3:y=5;let R=g*3;if(c+R>it&&(f=A(c+R)),g<64||!r){let T,C,L,E=c+y;for(T=0;T<g;T++)C=u.charCodeAt(T),C<128?f[E++]=C:C<2048?(f[E++]=C>>6|192,f[E++]=C&63|128):(C&64512)===55296&&((L=u.charCodeAt(T+1))&64512)===56320?(C=65536+((C&1023)<<10)+(L&1023),T++,f[E++]=C>>18|240,f[E++]=C>>12&63|128,f[E++]=C>>6&63|128,f[E++]=C&63|128):(f[E++]=C>>12|224,f[E++]=C>>6&63|128,f[E++]=C&63|128);p=E-c-y}else p=r(u,c+y);p<32?f[c++]=160|p:p<256?(y<2&&f.copyWithin(c+2,c+1,c+1+p),f[c++]=217,f[c++]=p):p<65536?(y<3&&f.copyWithin(c+3,c+2,c+2+p),f[c++]=218,f[c++]=p>>8,f[c++]=p&255):(y<5&&f.copyWithin(c+5,c+3,c+3+p),f[c++]=219,H.setUint32(c,p),c+=4),c+=p}else if(S===\"number\")if(u>>>0===u)u<64||u<128&&this.useRecords===!1?f[c++]=u:u<256?(f[c++]=204,f[c++]=u):u<65536?(f[c++]=205,f[c++]=u>>8,f[c++]=u&255):(f[c++]=206,H.setUint32(c,u),c+=4);else if(u>>0===u)u>=-32?f[c++]=256+u:u>=-128?(f[c++]=208,f[c++]=u+256):u>=-32768?(f[c++]=209,H.setInt16(c,u),c+=2):(f[c++]=210,H.setInt32(c,u),c+=4);else{let g;if((g=this.useFloat32)>0&&u<4294967296&&u>=-2147483648){f[c++]=202,H.setFloat32(c,u);let y;if(g<4||(y=u*Fi[(f[c]&127)<<1|f[c+1]>>7])>>0===y){c+=4;return}else c--}f[c++]=203,H.setFloat64(c,u),c+=8}else if(S===\"object\")if(!u)f[c++]=192;else{if(s){let y=s.get(u);if(y){if(!y.id){let R=s.idsToInsert||(s.idsToInsert=[]);y.id=R.push(y)}f[c++]=214,f[c++]=112,H.setUint32(c,y.id),c+=4;return}else s.set(u,{offset:c-e})}let g=u.constructor;if(g===Object)m(u,!0);else if(g===Array){p=u.length,p<16?f[c++]=144|p:p<65536?(f[c++]=220,f[c++]=p>>8,f[c++]=p&255):(f[c++]=221,H.setUint32(c,p),c+=4);for(let y=0;y<p;y++)k(u[y])}else if(g===Map){p=u.size,p<16?f[c++]=128|p:p<65536?(f[c++]=222,f[c++]=p>>8,f[c++]=p&255):(f[c++]=223,H.setUint32(c,p),c+=4);for(let[y,R]of u)k(y),k(R)}else{for(let y=0,R=Si.length;y<R;y++){let T=Js[y];if(u instanceof T){let C=Si[y];if(C.write){C.type&&(f[c++]=212,f[c++]=C.type,f[c++]=0),k(C.write.call(this,u));return}let L=f,E=H,at=c;f=null;let Et;try{Et=C.pack.call(this,u,re=>(f=L,L=null,c+=re,c>it&&A(c),{target:f,targetView:H,position:c-re}),k)}finally{L&&(f=L,H=E,c=at,it=f.length-10)}Et&&(Et.length+c>it&&A(Et.length+c),c=_n(Et,f,c,C.type));return}}m(u,!u.hasOwnProperty)}}else if(S===\"boolean\")f[c++]=u?195:194;else if(S===\"bigint\"){if(u<BigInt(1)<<BigInt(63)&&u>=-(BigInt(1)<<BigInt(63)))f[c++]=211,H.setBigInt64(c,u);else if(u<BigInt(1)<<BigInt(64)&&u>0)f[c++]=207,H.setBigUint64(c,u);else if(this.largeBigIntToFloat)f[c++]=203,H.setFloat64(c,Number(u));else throw new RangeError(u+\" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64\");c+=8}else if(S===\"undefined\")this.encodeUndefinedAsNil?f[c++]=192:(f[c++]=212,f[c++]=0,f[c++]=0);else if(S===\"function\")k(this.writeFunction&&this.writeFunction());else throw new Error(\"Unknown type: \"+S)},m=this.useRecords===!1?this.variableMapSize?u=>{let S=Object.keys(u),p=S.length;p<16?f[c++]=128|p:p<65536?(f[c++]=222,f[c++]=p>>8,f[c++]=p&255):(f[c++]=223,H.setUint32(c,p),c+=4);let g;for(let y=0;y<p;y++)k(g=S[y]),k(u[g])}:(u,S)=>{f[c++]=222;let p=c-e;c+=2;let g=0;for(let y in u)(S||u.hasOwnProperty(y))&&(k(y),k(u[y]),g++);f[p+++e]=g>>8,f[p+e]=g&255}:t.progressiveRecords&&!w?(u,S)=>{let p,g=a.transitions||(a.transitions=Object.create(null)),y=c++-e,R;for(let T in u)if(S||u.hasOwnProperty(T)){if(p=g[T],p)g=p;else{let C=Object.keys(u),L=g;g=a.transitions;let E=0;for(let at=0,Et=C.length;at<Et;at++){let re=C[at];p=g[re],p||(p=g[re]=Object.create(null),E++),g=p}y+e+1==c?(c--,Z(g,C,E)):F(g,C,y,E),R=!0,g=L[T]}k(u[T])}if(!R){let T=g[qt];T?f[y+e]=T:F(g,Object.keys(u),y,0)}}:(u,S)=>{let p,g=a.transitions||(a.transitions=Object.create(null)),y=0;for(let T in u)(S||u.hasOwnProperty(T))&&(p=g[T],p||(p=g[T]=Object.create(null),y++),g=p);let R=g[qt];R?R>=96&&w?(f[c++]=((R-=96)&31)+96,f[c++]=R>>5):f[c++]=R:Z(g,g.__keys__||Object.keys(u),y);for(let T in u)(S||u.hasOwnProperty(T))&&k(u[T])},A=u=>{let S;if(u>16777216){if(u-e>Qi)throw new Error(\"Packed buffer would be larger than maximum buffer size\");S=Math.min(Qi,Math.round(Math.max((u-e)*(u>67108864?1.25:2),4194304)/4096)*4096)}else S=(Math.max(u-e<<2,f.length-1)>>12)+1<<12;let p=new Fe(S);return H=new DataView(p.buffer,0,S),u=Math.min(u,f.length),f.copy?f.copy(p,0,e,u):p.set(f.slice(e,u)),c-=e,e=0,it=p.length-10,f=p},Z=(u,S,p)=>{let g=a.nextId;g||(g=64),g<_&&this.shouldShareStructure&&!this.shouldShareStructure(S)?(g=a.nextOwnId,g<V||(g=_),a.nextOwnId=g+1):(g>=V&&(g=_),a.nextId=g+1);let y=S.highByte=g>=96&&w?g-96>>5:-1;u[qt]=g,u.__keys__=S,a[g-64]=S,g<_?(S.isShared=!0,a.sharedLength=g-63,i=!0,y>=0?(f[c++]=(g&31)+96,f[c++]=y):f[c++]=g):(y>=0?(f[c++]=213,f[c++]=114,f[c++]=(g&31)+96,f[c++]=y):(f[c++]=212,f[c++]=114,f[c++]=g),p&&(x+=I*p),U.length>=O&&(U.shift()[qt]=0),U.push(u),k(S))},F=(u,S,p,g)=>{let y=f,R=c,T=it,C=e;f=oe,c=0,e=0,f||(oe=f=new Fe(8192)),it=f.length-10,Z(u,S,g),oe=f;let L=c;if(f=y,c=R,it=T,e=C,L>1){let E=c+L-1;E>it&&A(E);let at=p+e;f.copyWithin(at+L,at+1,c),f.set(oe.slice(0,L),at),c=E}else f[p+e]=oe[0]}}useBuffer(t){f=t,H=new DataView(f.buffer,f.byteOffset,f.byteLength),c=0}clearSharedData(){this.structures&&(this.structures=[])}};Js=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Hs];Si=[{pack(t,e,i){let a=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&a>=0&&a<4294967296){let{target:s,targetView:n,position:r}=e(6);s[r++]=214,s[r++]=255,n.setUint32(r,a)}else if(a>0&&a<4294967296){let{target:s,targetView:n,position:r}=e(10);s[r++]=215,s[r++]=255,n.setUint32(r,t.getMilliseconds()*4e6+(a/1e3/4294967296>>0)),n.setUint32(r+4,a)}else if(isNaN(a)){if(this.onInvalidDate)return e(0),i(this.onInvalidDate());let{target:s,targetView:n,position:r}=e(3);s[r++]=212,s[r++]=255,s[r++]=255}else{let{target:s,targetView:n,position:r}=e(15);s[r++]=199,s[r++]=12,s[r++]=255,n.setUint32(r,t.getMilliseconds()*1e6),n.setBigInt64(r+4,BigInt(Math.floor(a)))}}},{pack(t,e,i){let a=Array.from(t),{target:s,position:n}=e(this.moreTypes?3:0);this.moreTypes&&(s[n++]=212,s[n++]=115,s[n++]=0),i(a)}},{pack(t,e,i){let{target:a,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(a[s++]=212,a[s++]=101,a[s++]=0),i([t.name,t.message])}},{pack(t,e,i){let{target:a,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(a[s++]=212,a[s++]=120,a[s++]=0),i([t.source,t.flags])}},{pack(t,e){this.moreTypes?Ji(t,16,e):ts(qe?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let i=t.constructor;i!==ta&&this.moreTypes?Ji(t,qs.indexOf(i.name),e):ts(t,e)}},{pack(t,e){let{target:i,position:a}=e(1);i[a]=193}}];function Ji(t,e,i,a){let s=t.byteLength;if(s+1<256){var{target:n,position:r}=i(4+s);n[r++]=199,n[r++]=s+1}else if(s+1<65536){var{target:n,position:r}=i(5+s);n[r++]=200,n[r++]=s+1>>8,n[r++]=s+1&255}else{var{target:n,position:r,targetView:o}=i(7+s);n[r++]=201,o.setUint32(r,s+1),r+=4}n[r++]=116,n[r++]=e,n.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),r)}function ts(t,e){let i=t.byteLength;var a,s;if(i<256){var{target:a,position:s}=e(i+2);a[s++]=196,a[s++]=i}else if(i<65536){var{target:a,position:s}=e(i+3);a[s++]=197,a[s++]=i>>8,a[s++]=i&255}else{var{target:a,position:s,targetView:n}=e(i+5);a[s++]=198,n.setUint32(s,i),s+=4}a.set(t,s)}function _n(t,e,i,a){let s=t.length;switch(s){case 1:e[i++]=212;break;case 2:e[i++]=213;break;case 4:e[i++]=214;break;case 8:e[i++]=215;break;case 16:e[i++]=216;break;default:s<256?(e[i++]=199,e[i++]=s):s<65536?(e[i++]=200,e[i++]=s>>8,e[i++]=s&255):(e[i++]=201,e[i++]=s>>24,e[i++]=s>>16&255,e[i++]=s>>8&255,e[i++]=s&255)}return e[i++]=a,e.set(t,i),i+=s,i}function pn(t,e){let i,a=e.length*6,s=t.length-a;for(e.sort((n,r)=>n.offset>r.offset?1:-1);i=e.pop();){let n=i.offset,r=i.id;t.copyWithin(n+a,n,s),a-=6;let o=n+a;t[o++]=214,t[o++]=105,t[o++]=r>>24,t[o++]=r>>16&255,t[o++]=r>>8&255,t[o++]=r&255,s=n}return t}function es(t,e){if(K.length>0){H.setUint32(K.position+t,c-K.position-t);let i=K;K=null,e(i[0]),e(i[1])}}var gn=new fn({useRecords:!1}),wn=gn.pack,yn=512,mn=1024,_e=t=>wn(t.toJSObject()),pe=(t,e)=>t.fromJSObject(cn(e)),ea=(t,e,i)=>{if(!e.thnkServer)return-1;let{stateVariables:a,objectsRegistery:s}=e.thnkServer,{publicStateVariable:n,privateStateVariable:r}=a,o=n.getChildrenCount()!==0?Q.createPublicStatePackedVector(t,_e(n)):null,b=r.getChild(i),l=b.getChildrenCount()!==0?Q.createPrivateStatePackedVector(t,_e(b)):null,h=s.createObjectsSnapshot(t,i),O=h.length?Q.createObjectsVector(t,h):null;return Q.startGameStateSnapshot(t),o&&Q.addPublicStatePacked(t,o),l&&Q.addPrivateStatePacked(t,l),O&&Q.addObjects(t,O),Q.endGameStateSnapshot(t)},vn=(t,e,i)=>{let a=new Bt(512),s=a.createString(i.getName()),n=ea(a,i,t);Zt.startConnectionStartMessage(a),Zt.addSceneName(a,s),Zt.addSceneSnapshot(a,n),e.sendServerMessageTo(t,a,ct.createServerMessage(a,1,Zt.endConnectionStartMessage(a)))},Sn=(t,e,i)=>{let a=new Bt(256),s=i.serialize(a,t);if(!s)return;Ot.startGameStateUpdateMessage(a),Ot.addScene(a,s);let n=Ot.endGameStateUpdateMessage(a);e.sendServerMessageTo(t,a,ct.createServerMessage(a,2,n))},kn=(t,e,i)=>{let a=new Bt(512),s=a.createString(e);dt.startSceneSwitchMessage(a),dt.addSceneName(a,s),dt.addIsPause(a,i),t.sendServerMessageToAll(a,ct.createServerMessage(a,3,dt.endSceneSwitchMessage(a)))},ii=(t,e,i)=>{for(let a of t){let s=new Bt(512),n=i?s.createString(i.getName()):null,r=i?ea(s,i,a):null;ht.startResumePreviousSceneMessage(s),r&&n&&(ht.addSnapshot(s,r),ht.addName(s,n));let o=ct.createServerMessage(s,4,ht.endResumePreviousSceneMessage(s));e.sendServerMessageTo(a,s,o)}},ia={};Ke(ia,{getCurrentPlayerID:()=>On,markObjectAsOwned:()=>An,pickOwnedObjects:()=>In,switchPlayerContext:()=>Ye});var ge=\"\",ki=new Map,On=()=>ge,Ye=t=>{ge=t},An=t=>{let e=ki.get(ge);e||ki.set(ge,e=new gdjs.LongLivedObjectsList),e.addObject(t.getName(),t)},In=t=>{let e=ki.get(ge);if(!e){for(let i of Object.values(t.items))i.length=0;return!1}for(let[i,a]of Object.entries(t.items))gdjs.copyArray(e.getObjects(i),a);return!0},is=new Map,Di=t=>{let e=is.get(t);return e||is.set(t,e=[]),e},jn=(t,e,i)=>{Di(e).push({initiatorUserID:t,serializedExtraData:i})},xn=(t,e,i)=>{Di(e).push({initiatorUserID:t,extraData:i})},Cn=(t,e)=>{let i=Di(t);if(i.length){let a=i.shift();return Ye(a.initiatorUserID),a.serializedExtraData?pe(e,a.serializedExtraData):a.extraData&&gdjs.Variable.copy(a.extraData,e),!0}return!1},Un=t=>{var e;return!!((e=t.thnkServer)!=null&&e.playerManager.popConnection())},Tn=t=>{var e;return!!((e=t.thnkServer)!=null&&e.playerManager.popDisconnection())},sa={};Ke(sa,{getTickRate:()=>Ri,isDedicated:()=>ra,setDedicated:()=>Vn,setTickRate:()=>Fn});var aa=!1,na=120,Vn=()=>{aa=!0},Fn=t=>{na=Math.max(1,t)},Ri=()=>na,ra=()=>aa,st=class extends gdjs.Variable{constructor(){super(...arguments),this.dirty=!0,this.operations=[]}static setupSyncedVariable(t,e){let i=new st;return t.has(e)&&gdjs.Variable.copy(t.get(e),i),t.add(e,i),i}static setupStateVariables(t){let e=st.setupSyncedVariable(t,\"State\"),i=st.setupSyncedVariable(t,\"PlayerState\"),a=st.setupSyncedVariable(t,\"TeamState\");return{publicStateVariable:e,privateStateVariable:i,teamStateVariable:a}}reinitialize(t){if(this._type=\"number\",this._value=0,this._str=\"0\",this._bool=!1,this._children={},this._childrenArray=[],this._undefinedInContainer=!1,t!==void 0){if(this._type=t.type||\"number\",this._type===\"number\")this._value=parseFloat(t.value||\"0\"),this._value!==this._value&&(this._value=0);else if(this._type===\"string\")this._str=\"\"+t.value||\"0\";else if(this._type===\"boolean\")this._bool=!!t.value;else if(this._type===\"structure\"){if(t.children!==void 0)for(var e=0,i=t.children.length;e<i;++e){var a=t.children[e];if(a.name===void 0)continue;let s=new st(a);this._children[a.name]=s,this.operations.push({type:1,targetName:a.name,targetVariable:s})}}else if(this._type===\"array\"&&t.children)for(let s of t.children){let n=new st(s);this._childrenArray.push(n),this.operations.push({type:1,targetName:s.name,targetVariable:n})}}}setBoolean(t){t!==this._bool&&(this.dirty=!0),super.setBoolean(t)}setNumber(t){t!==this._value&&(this.dirty=!0),super.setNumber(t)}setString(t){t!==this._str&&(this.dirty=!0),super.setString(t)}clearChildren(){this.dirty=!0,this.operations.length=0,this.operations.push({type:3}),super.clearChildren()}static _convertToSyncedVariable(t){let e=t;if(Object.getPrototypeOf(e)!==st.prototype){if(Object.setPrototypeOf(e,st.prototype),e.operations=[],e.dirty=!0,e._type===\"array\"){let i=e._childrenArray.length;for(let a=0;a<i;a++)e.operations.push({type:1,targetName:a,targetVariable:this._convertToSyncedVariable(e._childrenArray[a])})}else if(e._type===\"structure\")for(let i in e._children)e.operations.push({type:1,targetName:i,targetVariable:this._convertToSyncedVariable(e._children[i])})}return e}addChild(t,e){return this.dirty=!0,e=st._convertToSyncedVariable(e),this.operations.push({type:1,targetName:t,targetVariable:e}),super.addChild(t,e)}getChild(t){if(this.isPrimitive()&&this.castTo(\"structure\"),this._type===\"array\")return this.getChildAt(parseInt(t,10)||0);if(this._children[t]===void 0||this._children[t]===null){this.dirty=!0;let e=new st;this._children[t]=e,this.operations.push({type:1,targetName:t,targetVariable:e})}return this._children[t]}getChildAt(t){if(this.castTo(\"array\"),this._childrenArray[t]===void 0||this._childrenArray[t]===null){this.dirty=!0;let e=new st;this._childrenArray[t]=e,this.operations.push({type:1,targetName:t,targetVariable:e})}return this._childrenArray[t]}removeChild(t){super.removeChild(t),this.operations.push({type:2,targetName:t})}removeAtIndex(t){super.removeAtIndex(t),this.operations.push({type:2,targetName:t})}pushValue(t){this.dirty=!0;let e=this._childrenArray.length;this.castTo(\"array\"),this._childrenArray.push(new st({type:typeof t,value:t})),this.operations.push({type:1,targetName:e,targetVariable:this._childrenArray[e]})}pushVariableCopy(t){this.dirty=!0;let e=this._childrenArray.length;this.castTo(\"array\"),this._childrenArray.push(gdjs.Variable.copy(t,new st)),this.operations.push({type:1,targetName:e,targetVariable:this._childrenArray[e]})}getAllChildrenArray(){return super.getAllChildrenArray()}getAllChildren(){return super.getAllChildren()}isDirty(){if(this.dirty)return!0;if(!this.isPrimitive()){for(let t of this.getAllChildrenArray())if(t.isDirty())return this.dirty=!0,!0}return!1}serialize(t){switch(this.dirty=!1,this.getType()){case\"number\":return B.startVariable(t),B.addType(t,2),B.addNumber(t,this._value),B.endVariable(t);case\"string\":let a=t.createSharedString(this._str);return B.startVariable(t),B.addType(t,1),B.addText(t,a),B.endVariable(t);case\"boolean\":return B.startVariable(t),B.addType(t,3),B.addBoolean(t,this._bool),B.endVariable(t)}let e=[];for(let a of this.operations){let s=typeof a.targetName==\"string\"?t.createString(a.targetName):null,n=typeof a.targetName==\"number\"?a.targetName:null,r=a.targetVariable?a.targetVariable.serialize(t):null;W.startCollectionOperation(t),W.addOperation(t,a.type),s&&W.addName(t,s),n&&W.addIndex(t,n),r&&W.addVal(t,r),e.push(W.endCollectionOperation(t))}if(this.operations.length=0,this._type===\"array\")for(let a in this._childrenArray){let s=+a,n=this._childrenArray[s];if(n.isDirty()){let r=n.serialize(t);W.startCollectionOperation(t),W.addOperation(t,1),W.addIndex(t,s),W.addVal(t,r),e.push(W.endCollectionOperation(t))}}else for(let[a,s]of Object.entries(this.getAllChildren()))if(s.isDirty()){let n=t.createString(a),r=s.serialize(t);W.startCollectionOperation(t),W.addOperation(t,1),W.addName(t,n),W.addVal(t,r),e.push(W.endCollectionOperation(t))}let i=B.createOperationsVector(t,e);return B.startVariable(t),B.addType(t,this._type===\"structure\"?4:5),B.addOperations(t,i),B.endVariable(t)}serializeToBinary(){let t=new Bt(64);return t.finish(this.serialize(t)),t.asUint8Array()}},Dn=class{constructor(){this.connectedPlayers=new Set,this.connectionsQueue=[],this.disconnectionsQueue=[]}_onConnect(t){this.connectedPlayers.add(t),this.connectionsQueue.push(t)}_onDisconnect(t){this.connectedPlayers.delete(t),this.disconnectionsQueue.push(t)}alreadyHas(t){return this.connectedPlayers.has(t)}popConnection(){return this.connectionsQueue.length?(Ye(this.connectionsQueue.shift()),!0):!1}popDisconnection(){return this.disconnectionsQueue.length?(Ye(this.disconnectionsQueue.shift()),!0):!1}},oa=(t,e)=>{let[i,a,s]=e.split(\";\").map(n=>parseInt(n,10));return Ui.createRGB(t,i,a,s)},Rn=(t,e,i)=>{let a=e.getString?t.createSharedString(e.getString()):null;j.startObjState(t),j.addX(t,e.getX()),j.addY(t,e.getY()),j.addHeight(t,e.getHeight()),j.addWidth(t,e.getWidth()),j.addAngle(t,e.getAngle()),e.getX()===0&&j.addSetXTo0(t,!0),e.getY()===0&&j.addSetYTo0(t,!0),e.getHeight()===0&&j.addSetHeightTo0(t,!0),e.getWidth()===0&&j.addSetWidthTo0(t,!0),e.getAngle()===0&&j.addSetAngleTo0(t,!0),e.getZOrder()<=65535?j.addZOrder(t,e.getZOrder()+1):j.addBigZOrder(t,e.getZOrder()+1),j.addVisible(t,e.isHidden()?1:2),e.isFlippedX&&j.addFlippedX(t,e.isFlippedX()?1:2),e.isFlippedY&&j.addFlippedY(t,e.isFlippedY()?1:2),e.getOpacity&&(e.getOpacity()!==0?j.addOpacity(t,e.getOpacity()):j.addSetOpacityTo0(t,!0)),e.getAnimation&&j.addAnimation(t,e.getAnimation()+1),e.getColor&&j.addTint(t,oa(t,e.getColor())),a&&j.addText(t,a);let s=j.endObjState(t),{stateVariables:n}=e,{publicStateVariable:r,privateStateVariable:o}=n,b=r.getChildrenCount()!==0?G.createPackedPublicStateVector(t,_e(r)):null,l=o.getChild(i),h=l.getChildrenCount()!==0?G.createPackedPrivateStateVector(t,_e(l)):null,O=t.createSharedString(e.getName());return G.startGameObject(t),G.addId(t,e.thnkID),G.addName(t,O),G.addObjState(t,s),b&&G.addPackedPublicState(t,b),h&&G.addPackedPrivateState(t,h),G.endGameObject(t)},Pn=new gdjs.Logger(\"THNK - Objects replication\"),zn=class{constructor(){this.recycledIDs=[],this.currentNewID=1,this.generateNewID=()=>{let t=this.recycledIDs.pop()??this.currentNewID++;return t>65535?(Pn.error(\"Maximum amount of simultaneously replicated objects reached! Weird stuff is going to happen...\"),t%65535):t},this.registeredObjects=new Map,this.createdObjects=new Map,this.deletedObjects=new Set}forEach(t){for(let e of this.registeredObjects.values())t(e)}registerObject(t){t.thnkID=this.generateNewID(),this.registeredObjects.set(t.thnkID,t),this.createdObjects.set(t.thnkID,t.getName()),t.stateVariables=st.setupStateVariables(t.getVariables())}unregisterObject(t){this.recycledIDs.push(t.thnkID),this.registeredObjects.delete(t.thnkID),this.deletedObjects.add(t.thnkID),this.createdObjects.delete(t.thnkID)}createObjectsSnapshot(t,e){let i=[];for(let a of this.registeredObjects.values())i.push(Rn(t,a,e));return i}getCreatedObjects(){let t=[...this.createdObjects.entries()];return this.createdObjects.clear(),t}getDeletedObjects(){let t=Uint16Array.from(this.deletedObjects.values());return this.deletedObjects.clear(),t}},Mn=class{constructor(){this.currentDiff=0,this.diffsCount=Math.min(30,Ri()*4),this.diffs=new Array(this.diffsCount)}createSnapshot(t){let e=la.createDiff(t);return e&&(this.diffs[++this.currentDiff%this.diffsCount]=e),e}getSnapshot(t){return this.currentDiff-t>this.diffsCount?null:this.diffs[t%this.diffsCount]}},la=class{constructor(){}static createDiff(t){let e=ha.createDiff(t);if(!e)return null;let i=new la;return i.sceneDiff=e,i}serialize(t,e){var i;return(i=this.sceneDiff)==null?void 0:i.serialize(t,e)}},ha=class{constructor(){this.privateStateVariablesDiffs=new Map,this.teamStateVariablesDiffs=new Map,this.objectsDiff=new Map,this.deletedObjects=new Set,this.createdObjects=new Map}static createDiff(t){let{thnkServer:e}=t;if(!e)throw new Error(\"Impossible to take a diff snapshot when not running a THNK server!\");let{stateVariables:i,objectsRegistery:a}=e,{publicStateVariable:s,privateStateVariable:n,teamStateVariable:r}=i,o=new ha;s.isDirty()&&(o.publicStateVariableDiff=s.serializeToBinary());{let b=n.getAllChildren();for(let l in b)b[l].isDirty()&&o.privateStateVariablesDiffs.set(l,b[l].serializeToBinary())}{let b=r.getAllChildren();for(let l in b)b[l].isDirty()&&o.teamStateVariablesDiffs.set(l,b[l].serializeToBinary())}a.forEach(b=>{let l=da.createDiff(b);l&&o.objectsDiff.set(b.thnkID,l)});for(let[b,l]of a.getCreatedObjects())o.createdObjects.set(b,l);for(let b of a.getDeletedObjects())o.deletedObjects.add(b);return o}serialize(t,e){let i=this.publicStateVariableDiff?Y.createPublicStateDiffVector(t,this.publicStateVariableDiff):null,a=this.privateStateVariablesDiffs.get(e),s=a?Y.createPrivateStateDiffVector(t,a):null,n=[];for(let l of this.objectsDiff.values())l.needsToBeSerialized(e)&&n.push(l.serialize(t,e));let r=n.length?Y.createObjectsVector(t,n):null,o=null;if(this.createdObjects.size){let l=new Uint16Array(this.createdObjects.size),h=0;for(let[O,w]of this.createdObjects){let _=t.createSharedString(w);l[h++]=Ut.createCreatedObject(t,O,_)}o=Y.createCreatedObjectsVector(t,l)}let b=this.deletedObjects.size?Y.createDeletedObjectsVector(t,[...this.deletedObjects]):null;return Y.startScene(t),i&&Y.addPublicStateDiff(t,i),s&&Y.addPrivateStateDiff(t,s),r&&Y.addObjects(t,r),o&&Y.addCreatedObjects(t,o),b&&Y.addDeletedObjects(t,b),Y.endScene(t)}},da=class{constructor(t,e){this.privateStateVariablesDiffs=new Map,this.teamStateVariablesDiffs=new Map,this.propertyChanged=!1,this.id=t,this.aabb=e}static createDiff(t){let e=new da(t.thnkID,t.getVisibilityAABB()||t.getAABB());t.getX()!==t.prevX&&(t.prevX=t.getX(),e.propertyChanged=!0,e.x=t.getX()),t.getY()!==t.prevY&&(t.prevY=t.getY(),e.propertyChanged=!0,e.y=t.getY()),t.getHeight()!==t.prevHeight&&(t.prevHeight=t.getHeight(),e.propertyChanged=!0,e.height=t.getHeight()),t.getWidth()!==t.prevWidth&&(t.prevWidth=t.getWidth(),e.propertyChanged=!0,e.width=t.getWidth()),t.getAngle()!==t.prevAngle&&(t.prevAngle=t.getAngle(),e.propertyChanged=!0,e.angle=t.getAngle()),t.getZOrder()!==t.prevZOrder&&(t.prevZOrder=t.getZOrder(),e.propertyChanged=!0,e.zOrder=t.getZOrder()),t.isHidden()!==t.prevVisibility&&(t.prevVisibility=t.isHidden(),e.propertyChanged=!0,e.hidden=t.isHidden()),t.isFlippedX&&t.isFlippedX()!==t.prevFlippedX&&(t.prevFlippedX=t.isFlippedX(),e.propertyChanged=!0,e.flippedX=t.isFlippedX()),t.isFlippedY&&t.isFlippedY()!==t.prevFlippedY&&(t.prevFlippedY=t.isFlippedY(),e.propertyChanged=!0,e.flippedY=t.isFlippedY()),t.getOpacity&&t.getOpacity()!==t.prevOpacity&&(t.prevOpacity=t.getOpacity(),e.propertyChanged=!0,e.opacity=t.getOpacity()),t.getString&&t.getString()!==t.prevText&&(t.prevText=t.getString(),e.propertyChanged=!0,e.string=t.getString()),t.getColor&&t.getColor()!==t.prevColor&&(t.prevColor=t.getColor(),e.propertyChanged=!0,e.color=t.getColor()),t.getAnimation&&t.getAnimation()!==t.prevAnimation&&(t.prevAnimation=t.getAnimation(),e.propertyChanged=!0,e.animation=t.getAnimation());let{publicStateVariable:i,privateStateVariable:a,teamStateVariable:s}=t.stateVariables;i.isDirty()&&(e.publicStateVariableDiff=i.serializeToBinary());{let n=a.getAllChildren();for(let r in n)n[r].isDirty()&&e.privateStateVariablesDiffs.set(r,n[r].serializeToBinary())}{let n=s.getAllChildren();for(let r in n)n[r].isDirty()&&e.teamStateVariablesDiffs.set(r,n[r].serializeToBinary())}return e.propertyChanged||e.publicStateVariableDiff||e.privateStateVariablesDiffs.size||e.teamStateVariablesDiffs.size?e:null}needsToBeSerialized(t){return this.propertyChanged||this.publicStateVariableDiff||this.privateStateVariablesDiffs.has(t)}serialize(t,e){let i=this.string!==void 0?t.createSharedString(this.string):null;this.propertyChanged&&(j.startObjState(t),this.x!==void 0&&(this.x===0?j.addSetXTo0(t,!0):j.addX(t,this.x)),this.y!==void 0&&(this.y===0?j.addSetYTo0(t,!0):j.addY(t,this.y)),this.height!==void 0&&(this.height===0?j.addSetHeightTo0(t,!0):j.addHeight(t,this.height)),this.width!==void 0&&(this.width===0?j.addSetWidthTo0(t,!0):j.addWidth(t,this.width)),this.angle!==void 0&&(this.angle===0?j.addSetAngleTo0(t,!0):j.addAngle(t,this.angle)),this.zOrder!==void 0&&(this.zOrder<=65535?j.addZOrder(t,this.zOrder+1):j.addBigZOrder(t,this.zOrder+1)),this.hidden!==void 0&&j.addVisible(t,this.hidden?1:2),this.flippedX!==void 0&&j.addFlippedX(t,this.flippedX?1:2),this.flippedY!==void 0&&j.addFlippedY(t,this.flippedY?1:2),this.opacity!==void 0&&(this.opacity===0?j.addSetOpacityTo0(t,!0):j.addOpacity(t,this.opacity)),this.animation!==void 0&&j.addAnimation(t,this.animation+1),i&&j.addText(t,i),this.color!==void 0&&j.addTint(t,oa(t,this.color)));let a=this.propertyChanged?j.endObjState(t):null,s=this.publicStateVariableDiff?G.createPublicStateDiffVector(t,this.publicStateVariableDiff):null,n=this.privateStateVariablesDiffs.get(e),r=n?G.createPrivateStateDiffVector(t,n):null;return G.startGameObject(t),G.addId(t,this.id),a&&G.addObjState(t,a),s&&G.addPublicStateDiff(t,s),r&&G.addPrivateStateDiff(t,r),G.endGameObject(t)}},Bn=class{constructor(t,e){this.objectsRegistery=new zn,this.playerManager=new Dn,this.runServerCode=!0,this.snapshotsManager=new Mn,this.adapter=t,this.stateVariables=e}},ca=(t,e)=>{t.thnkServer=new Bn(e,st.setupStateVariables(t.getVariables())),ra()||t.thnkServer.playerManager._onConnect(e.getServerID())},Oi=new gdjs.Logger(\"THNK - Server\"),si=0,En=t=>{if(!t.thnkServer)return;let{adapter:e}=t.thnkServer;for(let[a,s]of e.getUsersPendingMessages()){for(let n of s)switch(n.contentType()){case 1:if(t.thnkServer.playerManager.alreadyHas(a))continue;vn(a,e,t),t.thnkServer.playerManager._onConnect(a);continue;case 2:let r=n.content(new mt),o=r.name();if(!o)continue;let b=r.contentArray();jn(a,o,b);continue;default:Oi.error(`Received message with unknown type '${n.contentType()}'`);continue}s.length=0}for(let a of e.getDisconnectedUsers())t.thnkServer.playerManager._onDisconnect(a);e.getDisconnectedUsers().length=0;let i=t.getTimeManager();si+=i.getElapsedTime()/i.getTimeScale(),si>1e3/Ri()&&(si=0,t.thnkServer.runServerCode=!0);{let a=t.thnkServer.adapter.getServerID(),s=r=>{let o=r.getChild(a).getAllChildren();for(let b in o)r.addChild(b,o[b])},{privateStateVariable:n}=t.thnkServer.stateVariables;s(n),t.thnkServer.objectsRegistery.forEach(r=>s(r.getVariables().get(\"PlayerState\")))}},Nn=t=>{if(!t.thnkServer||!t.thnkServer.runServerCode)return;t.thnkServer.runServerCode=!1;let{snapshotsManager:e}=t.thnkServer,i=e.createSnapshot(t);if(i)for(let a of t.thnkServer.playerManager.connectedPlayers.values())Sn(a,t.thnkServer.adapter,i)},Jt=null,ba=(t,e)=>{if(t.thnkServer){let{adapter:i}=t.thnkServer;Jt={adapter:i,isPause:e},e&&(t.thnkServer.previouslyConnectedUsers=new Set(i.getConnectedUsers()))}},Zn=t=>{if(Jt){let{adapter:e,isPause:i}=Jt;ca(t,e);for(let a of e.getConnectedUsers())t.thnkServer.playerManager._onConnect(a);kn(e,t.getName(),i),Jt=null}},Ln=t=>{if(Jt)if(t.thnkServer){let{adapter:e,previouslyConnectedUsers:i}=t.thnkServer;if(i){let a=[],s=[];for(let n of e.getConnectedUsers())i.has(n)?s.push(n):a.push(n);ii(a,e,t),ii(s,e)}else Oi.warn(\"List of previously connected players not found! A full snapshot will be sent to all players. This is likely a bug, please open an issue on the THNK GitHub page!\"),ii([...e.getConnectedUsers()],e,t)}else Oi.warn(\"Resumed a scene that is not a server, shutting the server down. This is likely a bug, please open an issue on the THNK GitHub page!\"),Jt.adapter.close()};gdjs.registerRuntimeScenePreEventsCallback(En);gdjs.registerRuntimeScenePostEventsCallback(Nn);gdjs.registerRuntimeSceneUnloadedCallback(t=>ba(t,!1));gdjs.registerRuntimeScenePausedCallback(t=>ba(t,!0));gdjs.registerRuntimeSceneLoadedCallback(Zn);gdjs.registerRuntimeSceneResumedCallback(Ln);var Hn=new gdjs.Logger(\"THNK - Server\"),Yn=async(t,e,i)=>{try{await t.prepare(e)}catch(s){Hn.error(\"Adapter crashed while starting server! Error: \",s);return}let a=i?e.getGame().getSceneStack().replace(i,!0):e;ca(a,t)},Gn={popMessage:Cn,addRawMessageToTheQueue:xn,popConnection:Un,popDisconnection:Tn},ua={};Ke(ua,{getConnectionState:()=>Qn,messages:()=>sr,startClient:()=>ir});var ie=(t,e)=>{switch(e.type()){case 1:return t.setString(e.text()),t;case 2:return t.setNumber(e.number()),t;case 3:return t.setBoolean(e.boolean()),t}if(e.type()===4){t.castTo(\"structure\");for(let i=e.operationsLength(),a=0,s=e.operations(0);a<i;s=e.operations(++a))switch(s.operation()){case 1:let n=s.name(),r=s.val();n&&r&&ie(t.getChild(n),r);continue;case 2:let o=s.name();o&&t.removeChild(o);continue;case 3:t.clearChildren();continue}}else{t.castTo(\"array\");for(let i=e.operationsLength(),a=0,s=e.operations(0);a<i;s=e.operations(++a))switch(s.operation()){case 1:let n=s.val();n&&ie(t.getChildAt(s.index()),n);continue;case 2:t.removeAtIndex(s.index());continue;case 3:t.clearChildren();continue}}return t},Xn=new Ui,fa=(t,e)=>{let i=t.objState();if(i){let o=i.x();o!==null&&e.setX(o);let b=i.y();b!==null&&e.setY(b);let l=i.height();l!==null&&e.setHeight(l);let h=i.width();h!==null&&e.setWidth(h);let O=i.angle();O!==null&&e.setAngle(O),i.setXTo0()&&e.setX(0),i.setYTo0()&&e.setY(0),i.setHeightTo0()&&e.setHeight(0),i.setWidthTo0()&&e.setWidth(0),i.setAngleTo0()&&e.setAngle(0);{let x=i.visible();x!==null&&e.hide(x===1);let I=i.flippedX();I!==null&&e.flipX&&e.flipX(I===1);let k=i.flippedY();k!==null&&e.flipY&&e.flipY(k===1)}let w=i.zOrder()??i.bigZOrder();w!==null&&e.setZOrder(w-1);let _=i.opacity();e.setOpacity&&(_!==null&&e.setOpacity(_),i.setOpacityTo0()&&e.setOpacity(0));let V=i.animation();V!==null&&e.setAnimation&&e.setAnimation(V-1);let U=i.text();if(U!==null&&e.setString&&e.setString(U),e.setColor){let x=i.tint(Xn);x&&e.setColor(`${x.r()};${x.g()};${x.b()}`)}}let a=e.getVariables().get(\"State\"),s=t.publicStateDiffArray();if(s)ie(a,B.getRootAsVariable(new jt(s)));else{let o=t.packedPublicStateArray();o&&pe(a,o)}let n=e.getVariables().get(\"PlayerState\"),r=t.privateStateDiffArray();if(r)ie(n,B.getRootAsVariable(new jt(r)));else{let o=t.packedPrivateStateArray();o&&pe(n,o)}},_a=(t,e)=>{if(!e.thnkClient)return;let{objectsRegistery:i}=e.thnkClient,a=t.publicStatePackedArray();a&&pe(e.getVariables().get(\"State\"),a);let s=t.privateStatePackedArray();if(s&&pe(e.getVariables().get(\"PlayerState\"),s),i.clear(),t.objectsLength()!==0)for(let n=t.objectsLength(),r=0,o=t.objects(0);r<n;o=t.objects(++r)){let b=o.name();if(!b)continue;let l=e.createObject(b);fa(o,l),i.registerObject(o.id(),l)}},Wn=(t,e)=>{if(!e.thnkClient)return;let{objectsRegistery:i}=e.thnkClient,a=t.publicStateDiffArray();a&&ie(e.getVariables().get(\"State\"),B.getRootAsVariable(new jt(a)));let s=t.privateStateDiffArray();s&&ie(e.getVariables().get(\"PlayerState\"),B.getRootAsVariable(new jt(s)));let n=t.deletedObjectsArray();if(n)for(let r of n)i.deleteObject(r);if(t.createdObjectsLength()!==0)for(let r=t.createdObjectsLength(),o=0,b=t.createdObjects(0);o<r;b=t.createdObjects(++o)){let l=b.name();if(!l)continue;let h=e.createObject(l);i.registerObject(b.id(),h)}if(t.objectsLength()!==0)for(let r=t.objectsLength(),o=0,b=t.objects(0);o<r;b=t.objects(++o)){let l=i.getObject(b.id());if(!l){let h=b.name();h&&(l=e.createObject(h),i.registerObject(b.id(),l))}l&&fa(b,l)}},ss=new gdjs.Logger(\"THNK - Client\"),Kn=t=>{if(!t.thnkClient)return;let{adapter:e}=t.thnkClient;for(let i of e.getPendingMessages())switch(i.contentType()){case 1:ss.warn(\"A second ConnectionStartMessage was received from the server. This is likely a bug, please open an issue on the THNK GitHub!\");continue;case 2:let a=i.content(new Ot).scene();a&&Wn(a,t);continue;case 3:let s=i.content(new dt),n=s.sceneName();if(!n){console.error(\"Server requested scene switch, but no scene name was sent! This is likely a bug, please open an issue on the THNK GitHub!\");continue}let r=s.isPause()?t.getGame().getSceneStack().push(n):t.getGame().getSceneStack().replace(n,!0);r.thnkClient=t.thnkClient,t=r;continue;case 4:let o=i.content(new ht),b=o.name(),l=null;try{l=b?t.getGame().getSceneStack().replace(b,!0):t.getGame().getSceneStack().pop()}catch{console.info(\"Error spotted!\")}if(!l)continue;let h=o.snapshot();h&&_a(h,l),l.thnkClient=t.thnkClient,t=l;continue;default:ss.error(`Received message with unknown type '${i.contentType()}'`)}e.markPendingMessagesAsRead()};gdjs.registerRuntimeScenePreEventsCallback(Kn);var qn=(t,e)=>{let i=new Bt(32),a=e?i.createString(e):null;Tt.startConnectionRequestMessage(i),a&&Tt.addToken(i,a);let s=Tt.endConnectionRequestMessage(i);t.sendClientMessage(i,vt.createClientMessage(i,1,s))},$n=(t,e,i)=>{let a=new Bt(256),s=a.createString(e),n=mt.createContentVector(a,_e(i)),r=mt.createClientInputMessage(a,s,n);t.sendClientMessage(a,vt.createClientMessage(a,2,r))},pa=\"disconnected\",ce=t=>pa=t,Qn=()=>pa,Jn=class{constructor(t){this.objectsRegistery=new Map,this.runtimeScene=t}registerObject(t,e){e.thnkID=t,this.objectsRegistery.set(t,e)}getObject(t){return this.objectsRegistery.get(t)}deleteObject(t){let e=this.objectsRegistery.get(t);!e||(e.deleteFromScene(this.runtimeScene),this.objectsRegistery.delete(t))}clear(){this.objectsRegistery.forEach(t=>t.deleteFromScene(this.runtimeScene)),this.objectsRegistery.clear()}},tr=class{constructor(t,e){this.adapter=t,this.objectsRegistery=new Jn(e)}},er=new gdjs.Logger(\"THNK - Client\"),as=t=>{ce(\"failed\"),er.error(\"Connection failed: \"+t)},ir=async(t,e)=>{ce(\"connecting\");let i=t.getGame().getSceneStack();try{await e.prepare(t)}catch{as(\"Adapter crashed while starting server!\");return}ce(\"loading\"),qn(e);let a=setInterval(()=>{let s=e.getPendingMessages().shift();if(!!s&&s.contentType()===1){clearInterval(a);let n=s.content(new Zt),r=n.sceneName(),o=n.sceneSnapshot();if(!r||!o){as(\"Server Connection Start Message was invalid, couldn't finish setting up the connection.\");return}let b=i.replace(r,!0);b.thnkClient=new tr(e,b),_a(o,b),ce(\"connected\")}},200)},sr={sendClientMessage:$n};function se(t){let e=t.length;for(;--e>=0;)t[e]=0}var ar=0,ga=1,nr=2,rr=3,or=258,Pi=29,je=256,we=je+1+Pi,te=30,zi=19,wa=2*we+1,Lt=15,ai=16,lr=7,Mi=256,ya=16,ma=17,va=18,Ai=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ee=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),hr=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Sa=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dr=512,St=new Array((we+2)*2);se(St);var be=new Array(te*2);se(be);var ye=new Array(dr);se(ye);var me=new Array(or-rr+1);se(me);var Bi=new Array(Pi);se(Bi);var Ge=new Array(te);se(Ge);function ni(t,e,i,a,s){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=a,this.max_length=s,this.has_stree=t&&t.length}var ka,Oa,Aa;function ri(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}var Ia=t=>t<256?ye[t]:ye[256+(t>>>7)],ve=(t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},rt=(t,e,i)=>{t.bi_valid>ai-i?(t.bi_buf|=e<<t.bi_valid&65535,ve(t,t.bi_buf),t.bi_buf=e>>ai-t.bi_valid,t.bi_valid+=i-ai):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},gt=(t,e,i)=>{rt(t,i[e*2],i[e*2+1])},ja=(t,e)=>{let i=0;do i|=t&1,t>>>=1,i<<=1;while(--e>0);return i>>>1},cr=t=>{t.bi_valid===16?(ve(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},br=(t,e)=>{let i=e.dyn_tree,a=e.max_code,s=e.stat_desc.static_tree,n=e.stat_desc.has_stree,r=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,b=e.stat_desc.max_length,l,h,O,w,_,V,U=0;for(w=0;w<=Lt;w++)t.bl_count[w]=0;for(i[t.heap[t.heap_max]*2+1]=0,l=t.heap_max+1;l<wa;l++)h=t.heap[l],w=i[i[h*2+1]*2+1]+1,w>b&&(w=b,U++),i[h*2+1]=w,!(h>a)&&(t.bl_count[w]++,_=0,h>=o&&(_=r[h-o]),V=i[h*2],t.opt_len+=V*(w+_),n&&(t.static_len+=V*(s[h*2+1]+_)));if(U!==0){do{for(w=b-1;t.bl_count[w]===0;)w--;t.bl_count[w]--,t.bl_count[w+1]+=2,t.bl_count[b]--,U-=2}while(U>0);for(w=b;w!==0;w--)for(h=t.bl_count[w];h!==0;)O=t.heap[--l],!(O>a)&&(i[O*2+1]!==w&&(t.opt_len+=(w-i[O*2+1])*i[O*2],i[O*2+1]=w),h--)}},xa=(t,e,i)=>{let a=new Array(Lt+1),s=0,n,r;for(n=1;n<=Lt;n++)a[n]=s=s+i[n-1]<<1;for(r=0;r<=e;r++){let o=t[r*2+1];o!==0&&(t[r*2]=ja(a[o]++,o))}},ur=()=>{let t,e,i,a,s,n=new Array(Lt+1);for(i=0,a=0;a<Pi-1;a++)for(Bi[a]=i,t=0;t<1<<Ai[a];t++)me[i++]=a;for(me[i-1]=a,s=0,a=0;a<16;a++)for(Ge[a]=s,t=0;t<1<<Ee[a];t++)ye[s++]=a;for(s>>=7;a<te;a++)for(Ge[a]=s<<7,t=0;t<1<<Ee[a]-7;t++)ye[256+s++]=a;for(e=0;e<=Lt;e++)n[e]=0;for(t=0;t<=143;)St[t*2+1]=8,t++,n[8]++;for(;t<=255;)St[t*2+1]=9,t++,n[9]++;for(;t<=279;)St[t*2+1]=7,t++,n[7]++;for(;t<=287;)St[t*2+1]=8,t++,n[8]++;for(xa(St,we+1,n),t=0;t<te;t++)be[t*2+1]=5,be[t*2]=ja(t,5);ka=new ni(St,Ai,je+1,we,Lt),Oa=new ni(be,Ee,0,te,Lt),Aa=new ni(new Array(0),hr,0,zi,lr)},Ca=t=>{let e;for(e=0;e<we;e++)t.dyn_ltree[e*2]=0;for(e=0;e<te;e++)t.dyn_dtree[e*2]=0;for(e=0;e<zi;e++)t.bl_tree[e*2]=0;t.dyn_ltree[Mi*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},Ua=t=>{t.bi_valid>8?ve(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},fr=(t,e,i,a)=>{Ua(t),a&&(ve(t,i),ve(t,~i)),t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i},ns=(t,e,i,a)=>{let s=e*2,n=i*2;return t[s]<t[n]||t[s]===t[n]&&a[e]<=a[i]},oi=(t,e,i)=>{let a=t.heap[i],s=i<<1;for(;s<=t.heap_len&&(s<t.heap_len&&ns(e,t.heap[s+1],t.heap[s],t.depth)&&s++,!ns(e,a,t.heap[s],t.depth));)t.heap[i]=t.heap[s],i=s,s<<=1;t.heap[i]=a},rs=(t,e,i)=>{let a,s,n=0,r,o;if(t.last_lit!==0)do a=t.pending_buf[t.d_buf+n*2]<<8|t.pending_buf[t.d_buf+n*2+1],s=t.pending_buf[t.l_buf+n],n++,a===0?gt(t,s,e):(r=me[s],gt(t,r+je+1,e),o=Ai[r],o!==0&&(s-=Bi[r],rt(t,s,o)),a--,r=Ia(a),gt(t,r,i),o=Ee[r],o!==0&&(a-=Ge[r],rt(t,a,o)));while(n<t.last_lit);gt(t,Mi,e)},Ii=(t,e)=>{let i=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,n=e.stat_desc.elems,r,o,b=-1,l;for(t.heap_len=0,t.heap_max=wa,r=0;r<n;r++)i[r*2]!==0?(t.heap[++t.heap_len]=b=r,t.depth[r]=0):i[r*2+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=b<2?++b:0,i[l*2]=1,t.depth[l]=0,t.opt_len--,s&&(t.static_len-=a[l*2+1]);for(e.max_code=b,r=t.heap_len>>1;r>=1;r--)oi(t,i,r);l=n;do r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],oi(t,i,1),o=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=o,i[l*2]=i[r*2]+i[o*2],t.depth[l]=(t.depth[r]>=t.depth[o]?t.depth[r]:t.depth[o])+1,i[r*2+1]=i[o*2+1]=l,t.heap[1]=l++,oi(t,i,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],br(t,e),xa(i,b,t.bl_count)},os=(t,e,i)=>{let a,s=-1,n,r=e[0*2+1],o=0,b=7,l=4;for(r===0&&(b=138,l=3),e[(i+1)*2+1]=65535,a=0;a<=i;a++)n=r,r=e[(a+1)*2+1],!(++o<b&&n===r)&&(o<l?t.bl_tree[n*2]+=o:n!==0?(n!==s&&t.bl_tree[n*2]++,t.bl_tree[ya*2]++):o<=10?t.bl_tree[ma*2]++:t.bl_tree[va*2]++,o=0,s=n,r===0?(b=138,l=3):n===r?(b=6,l=3):(b=7,l=4))},ls=(t,e,i)=>{let a,s=-1,n,r=e[0*2+1],o=0,b=7,l=4;for(r===0&&(b=138,l=3),a=0;a<=i;a++)if(n=r,r=e[(a+1)*2+1],!(++o<b&&n===r)){if(o<l)do gt(t,n,t.bl_tree);while(--o!==0);else n!==0?(n!==s&&(gt(t,n,t.bl_tree),o--),gt(t,ya,t.bl_tree),rt(t,o-3,2)):o<=10?(gt(t,ma,t.bl_tree),rt(t,o-3,3)):(gt(t,va,t.bl_tree),rt(t,o-11,7));o=0,s=n,r===0?(b=138,l=3):n===r?(b=6,l=3):(b=7,l=4)}},_r=t=>{let e;for(os(t,t.dyn_ltree,t.l_desc.max_code),os(t,t.dyn_dtree,t.d_desc.max_code),Ii(t,t.bl_desc),e=zi-1;e>=3&&t.bl_tree[Sa[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},pr=(t,e,i,a)=>{let s;for(rt(t,e-257,5),rt(t,i-1,5),rt(t,a-4,4),s=0;s<a;s++)rt(t,t.bl_tree[Sa[s]*2+1],3);ls(t,t.dyn_ltree,e-1),ls(t,t.dyn_dtree,i-1)},gr=t=>{let e=4093624447,i;for(i=0;i<=31;i++,e>>>=1)if(e&1&&t.dyn_ltree[i*2]!==0)return 0;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return 1;for(i=32;i<je;i++)if(t.dyn_ltree[i*2]!==0)return 1;return 0},hs=!1,wr=t=>{hs||(ur(),hs=!0),t.l_desc=new ri(t.dyn_ltree,ka),t.d_desc=new ri(t.dyn_dtree,Oa),t.bl_desc=new ri(t.bl_tree,Aa),t.bi_buf=0,t.bi_valid=0,Ca(t)},Ta=(t,e,i,a)=>{rt(t,(ar<<1)+(a?1:0),3),fr(t,e,i,!0)},yr=t=>{rt(t,ga<<1,3),gt(t,Mi,St),cr(t)},mr=(t,e,i,a)=>{let s,n,r=0;t.level>0?(t.strm.data_type===2&&(t.strm.data_type=gr(t)),Ii(t,t.l_desc),Ii(t,t.d_desc),r=_r(t),s=t.opt_len+3+7>>>3,n=t.static_len+3+7>>>3,n<=s&&(s=n)):s=n=i+5,i+4<=s&&e!==-1?Ta(t,e,i,a):t.strategy===4||n===s?(rt(t,(ga<<1)+(a?1:0),3),rs(t,St,be)):(rt(t,(nr<<1)+(a?1:0),3),pr(t,t.l_desc.max_code+1,t.d_desc.max_code+1,r+1),rs(t,t.dyn_ltree,t.dyn_dtree)),Ca(t),a&&Ua(t)},vr=(t,e,i)=>(t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=i&255,t.last_lit++,e===0?t.dyn_ltree[i*2]++:(t.matches++,e--,t.dyn_ltree[(me[i]+je+1)*2]++,t.dyn_dtree[Ia(e)*2]++),t.last_lit===t.lit_bufsize-1),Sr=wr,kr=Ta,Or=mr,Ar=vr,Ir=yr,jr={_tr_init:Sr,_tr_stored_block:kr,_tr_flush_block:Or,_tr_tally:Ar,_tr_align:Ir},xr=(t,e,i,a)=>{let s=t&65535|0,n=t>>>16&65535|0,r=0;for(;i!==0;){r=i>2e3?2e3:i,i-=r;do s=s+e[a++]|0,n=n+s|0;while(--r);s%=65521,n%=65521}return s|n<<16|0},Se=xr,Cr=()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var a=0;a<8;a++)t=t&1?3988292384^t>>>1:t>>>1;e[i]=t}return e},Ur=new Uint32Array(Cr()),Tr=(t,e,i,a)=>{let s=Ur,n=a+i;t^=-1;for(let r=a;r<n;r++)t=t>>>8^s[(t^e[r])&255];return t^-1},$=Tr,Yt={2:\"need dictionary\",1:\"stream end\",0:\"\",\"-1\":\"file error\",\"-2\":\"stream error\",\"-3\":\"data error\",\"-4\":\"insufficient memory\",\"-5\":\"buffer error\",\"-6\":\"incompatible version\"},ae={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:Vr,_tr_stored_block:Fr,_tr_flush_block:Dr,_tr_tally:Pt,_tr_align:Rr}=jr,{Z_NO_FLUSH:Kt,Z_PARTIAL_FLUSH:Pr,Z_FULL_FLUSH:zr,Z_FINISH:zt,Z_BLOCK:ds,Z_OK:wt,Z_STREAM_END:cs,Z_STREAM_ERROR:bt,Z_DATA_ERROR:Mr,Z_BUF_ERROR:li,Z_DEFAULT_COMPRESSION:Br,Z_FILTERED:Er,Z_HUFFMAN_ONLY:De,Z_RLE:Nr,Z_FIXED:Zr,Z_DEFAULT_STRATEGY:Lr,Z_UNKNOWN:Hr,Z_DEFLATED:$e}=ae,Yr=9,Gr=15,Xr=8,Wr=29,Kr=256,ji=Kr+1+Wr,qr=30,$r=19,Qr=2*ji+1,Jr=15,D=3,Dt=258,ut=Dt+D+1,to=32,Qe=42,xi=69,Ne=73,Ze=91,Le=103,Ht=113,he=666,tt=1,xe=2,Gt=3,ne=4,eo=3,Rt=(t,e)=>(t.msg=Yt[e],e),bs=t=>(t<<1)-(t>4?9:0),Vt=t=>{let e=t.length;for(;--e>=0;)t[e]=0},io=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask,Mt=io,xt=t=>{let e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),i!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,e.pending===0&&(e.pending_out=0))},et=(t,e)=>{Dr(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,xt(t.strm)},P=(t,e)=>{t.pending_buf[t.pending++]=e},le=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},so=(t,e,i,a)=>{let s=t.avail_in;return s>a&&(s=a),s===0?0:(t.avail_in-=s,e.set(t.input.subarray(t.next_in,t.next_in+s),i),t.state.wrap===1?t.adler=Se(t.adler,e,s,i):t.state.wrap===2&&(t.adler=$(t.adler,e,s,i)),t.next_in+=s,t.total_in+=s,s)},Va=(t,e)=>{let i=t.max_chain_length,a=t.strstart,s,n,r=t.prev_length,o=t.nice_match,b=t.strstart>t.w_size-ut?t.strstart-(t.w_size-ut):0,l=t.window,h=t.w_mask,O=t.prev,w=t.strstart+Dt,_=l[a+r-1],V=l[a+r];t.prev_length>=t.good_match&&(i>>=2),o>t.lookahead&&(o=t.lookahead);do if(s=e,!(l[s+r]!==V||l[s+r-1]!==_||l[s]!==l[a]||l[++s]!==l[a+1])){a+=2,s++;do;while(l[++a]===l[++s]&&l[++a]===l[++s]&&l[++a]===l[++s]&&l[++a]===l[++s]&&l[++a]===l[++s]&&l[++a]===l[++s]&&l[++a]===l[++s]&&l[++a]===l[++s]&&a<w);if(n=Dt-(w-a),a=w-Dt,n>r){if(t.match_start=e,r=n,n>=o)break;_=l[a+r-1],V=l[a+r]}}while((e=O[e&h])>b&&--i!==0);return r<=t.lookahead?r:t.lookahead},Xt=t=>{let e=t.w_size,i,a,s,n,r;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-ut)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,a=t.hash_size,i=a;do s=t.head[--i],t.head[i]=s>=e?s-e:0;while(--a);a=e,i=a;do s=t.prev[--i],t.prev[i]=s>=e?s-e:0;while(--a);n+=e}if(t.strm.avail_in===0)break;if(a=so(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=a,t.lookahead+t.insert>=D)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=Mt(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=Mt(t,t.ins_h,t.window[r+D-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<D)););}while(t.lookahead<ut&&t.strm.avail_in!==0)},ao=(t,e)=>{let i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Xt(t),t.lookahead===0&&e===Kt)return tt;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;let a=t.block_start+i;if((t.strstart===0||t.strstart>=a)&&(t.lookahead=t.strstart-a,t.strstart=a,et(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-ut&&(et(t,!1),t.strm.avail_out===0))return tt}return t.insert=0,e===zt?(et(t,!0),t.strm.avail_out===0?Gt:ne):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),tt)},hi=(t,e)=>{let i,a;for(;;){if(t.lookahead<ut){if(Xt(t),t.lookahead<ut&&e===Kt)return tt;if(t.lookahead===0)break}if(i=0,t.lookahead>=D&&(t.ins_h=Mt(t,t.ins_h,t.window[t.strstart+D-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),i!==0&&t.strstart-i<=t.w_size-ut&&(t.match_length=Va(t,i)),t.match_length>=D)if(a=Pt(t,t.strstart-t.match_start,t.match_length-D),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=D){t.match_length--;do t.strstart++,t.ins_h=Mt(t,t.ins_h,t.window[t.strstart+D-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Mt(t,t.ins_h,t.window[t.strstart+1]);else a=Pt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(a&&(et(t,!1),t.strm.avail_out===0))return tt}return t.insert=t.strstart<D-1?t.strstart:D-1,e===zt?(et(t,!0),t.strm.avail_out===0?Gt:ne):t.last_lit&&(et(t,!1),t.strm.avail_out===0)?tt:xe},$t=(t,e)=>{let i,a,s;for(;;){if(t.lookahead<ut){if(Xt(t),t.lookahead<ut&&e===Kt)return tt;if(t.lookahead===0)break}if(i=0,t.lookahead>=D&&(t.ins_h=Mt(t,t.ins_h,t.window[t.strstart+D-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=D-1,i!==0&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-ut&&(t.match_length=Va(t,i),t.match_length<=5&&(t.strategy===Er||t.match_length===D&&t.strstart-t.match_start>4096)&&(t.match_length=D-1)),t.prev_length>=D&&t.match_length<=t.prev_length){s=t.strstart+t.lookahead-D,a=Pt(t,t.strstart-1-t.prev_match,t.prev_length-D),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=s&&(t.ins_h=Mt(t,t.ins_h,t.window[t.strstart+D-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=D-1,t.strstart++,a&&(et(t,!1),t.strm.avail_out===0))return tt}else if(t.match_available){if(a=Pt(t,0,t.window[t.strstart-1]),a&&et(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return tt}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(a=Pt(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<D-1?t.strstart:D-1,e===zt?(et(t,!0),t.strm.avail_out===0?Gt:ne):t.last_lit&&(et(t,!1),t.strm.avail_out===0)?tt:xe},no=(t,e)=>{let i,a,s,n,r=t.window;for(;;){if(t.lookahead<=Dt){if(Xt(t),t.lookahead<=Dt&&e===Kt)return tt;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=D&&t.strstart>0&&(s=t.strstart-1,a=r[s],a===r[++s]&&a===r[++s]&&a===r[++s])){n=t.strstart+Dt;do;while(a===r[++s]&&a===r[++s]&&a===r[++s]&&a===r[++s]&&a===r[++s]&&a===r[++s]&&a===r[++s]&&a===r[++s]&&s<n);t.match_length=Dt-(n-s),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=D?(i=Pt(t,1,t.match_length-D),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=Pt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(et(t,!1),t.strm.avail_out===0))return tt}return t.insert=0,e===zt?(et(t,!0),t.strm.avail_out===0?Gt:ne):t.last_lit&&(et(t,!1),t.strm.avail_out===0)?tt:xe},ro=(t,e)=>{let i;for(;;){if(t.lookahead===0&&(Xt(t),t.lookahead===0)){if(e===Kt)return tt;break}if(t.match_length=0,i=Pt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(et(t,!1),t.strm.avail_out===0))return tt}return t.insert=0,e===zt?(et(t,!0),t.strm.avail_out===0?Gt:ne):t.last_lit&&(et(t,!1),t.strm.avail_out===0)?tt:xe};function _t(t,e,i,a,s){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=a,this.func=s}var de=[new _t(0,0,0,0,ao),new _t(4,4,8,4,hi),new _t(4,5,16,8,hi),new _t(4,6,32,32,hi),new _t(4,4,16,16,$t),new _t(8,16,32,32,$t),new _t(8,16,128,128,$t),new _t(8,32,128,256,$t),new _t(32,128,258,1024,$t),new _t(32,258,258,4096,$t)],oo=t=>{t.window_size=2*t.w_size,Vt(t.head),t.max_lazy_match=de[t.level].max_lazy,t.good_match=de[t.level].good_length,t.nice_match=de[t.level].nice_length,t.max_chain_length=de[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=D-1,t.match_available=0,t.ins_h=0};function lo(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=$e,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Qr*2),this.dyn_dtree=new Uint16Array((2*qr+1)*2),this.bl_tree=new Uint16Array((2*$r+1)*2),Vt(this.dyn_ltree),Vt(this.dyn_dtree),Vt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Jr+1),this.heap=new Uint16Array(2*ji+1),Vt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*ji+1),Vt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Fa=t=>{if(!t||!t.state)return Rt(t,bt);t.total_in=t.total_out=0,t.data_type=Hr;let e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?Qe:Ht,t.adler=e.wrap===2?0:1,e.last_flush=Kt,Vr(e),wt},Da=t=>{let e=Fa(t);return e===wt&&oo(t.state),e},ho=(t,e)=>!t||!t.state||t.state.wrap!==2?bt:(t.state.gzhead=e,wt),Ra=(t,e,i,a,s,n)=>{if(!t)return bt;let r=1;if(e===Br&&(e=6),a<0?(r=0,a=-a):a>15&&(r=2,a-=16),s<1||s>Yr||i!==$e||a<8||a>15||e<0||e>9||n<0||n>Zr)return Rt(t,bt);a===8&&(a=9);let o=new lo;return t.state=o,o.strm=t,o.wrap=r,o.gzhead=null,o.w_bits=a,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=s+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+D-1)/D),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<s+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=e,o.strategy=n,o.method=i,Da(t)},co=(t,e)=>Ra(t,e,$e,Gr,Xr,Lr),bo=(t,e)=>{let i,a;if(!t||!t.state||e>ds||e<0)return t?Rt(t,bt):bt;let s=t.state;if(!t.output||!t.input&&t.avail_in!==0||s.status===he&&e!==zt)return Rt(t,t.avail_out===0?li:bt);s.strm=t;let n=s.last_flush;if(s.last_flush=e,s.status===Qe)if(s.wrap===2)t.adler=0,P(s,31),P(s,139),P(s,8),s.gzhead?(P(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),P(s,s.gzhead.time&255),P(s,s.gzhead.time>>8&255),P(s,s.gzhead.time>>16&255),P(s,s.gzhead.time>>24&255),P(s,s.level===9?2:s.strategy>=De||s.level<2?4:0),P(s,s.gzhead.os&255),s.gzhead.extra&&s.gzhead.extra.length&&(P(s,s.gzhead.extra.length&255),P(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(t.adler=$(t.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=xi):(P(s,0),P(s,0),P(s,0),P(s,0),P(s,0),P(s,s.level===9?2:s.strategy>=De||s.level<2?4:0),P(s,eo),s.status=Ht);else{let r=$e+(s.w_bits-8<<4)<<8,o=-1;s.strategy>=De||s.level<2?o=0:s.level<6?o=1:s.level===6?o=2:o=3,r|=o<<6,s.strstart!==0&&(r|=to),r+=31-r%31,s.status=Ht,le(s,r),s.strstart!==0&&(le(s,t.adler>>>16),le(s,t.adler&65535)),t.adler=1}if(s.status===xi)if(s.gzhead.extra){for(i=s.pending;s.gzindex<(s.gzhead.extra.length&65535)&&!(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(t.adler=$(t.adler,s.pending_buf,s.pending-i,i)),xt(t),i=s.pending,s.pending===s.pending_buf_size));)P(s,s.gzhead.extra[s.gzindex]&255),s.gzindex++;s.gzhead.hcrc&&s.pending>i&&(t.adler=$(t.adler,s.pending_buf,s.pending-i,i)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=Ne)}else s.status=Ne;if(s.status===Ne)if(s.gzhead.name){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(t.adler=$(t.adler,s.pending_buf,s.pending-i,i)),xt(t),i=s.pending,s.pending===s.pending_buf_size)){a=1;break}s.gzindex<s.gzhead.name.length?a=s.gzhead.name.charCodeAt(s.gzindex++)&255:a=0,P(s,a)}while(a!==0);s.gzhead.hcrc&&s.pending>i&&(t.adler=$(t.adler,s.pending_buf,s.pending-i,i)),a===0&&(s.gzindex=0,s.status=Ze)}else s.status=Ze;if(s.status===Ze)if(s.gzhead.comment){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(t.adler=$(t.adler,s.pending_buf,s.pending-i,i)),xt(t),i=s.pending,s.pending===s.pending_buf_size)){a=1;break}s.gzindex<s.gzhead.comment.length?a=s.gzhead.comment.charCodeAt(s.gzindex++)&255:a=0,P(s,a)}while(a!==0);s.gzhead.hcrc&&s.pending>i&&(t.adler=$(t.adler,s.pending_buf,s.pending-i,i)),a===0&&(s.status=Le)}else s.status=Le;if(s.status===Le&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&xt(t),s.pending+2<=s.pending_buf_size&&(P(s,t.adler&255),P(s,t.adler>>8&255),t.adler=0,s.status=Ht)):s.status=Ht),s.pending!==0){if(xt(t),t.avail_out===0)return s.last_flush=-1,wt}else if(t.avail_in===0&&bs(e)<=bs(n)&&e!==zt)return Rt(t,li);if(s.status===he&&t.avail_in!==0)return Rt(t,li);if(t.avail_in!==0||s.lookahead!==0||e!==Kt&&s.status!==he){let r=s.strategy===De?ro(s,e):s.strategy===Nr?no(s,e):de[s.level].func(s,e);if((r===Gt||r===ne)&&(s.status=he),r===tt||r===Gt)return t.avail_out===0&&(s.last_flush=-1),wt;if(r===xe&&(e===Pr?Rr(s):e!==ds&&(Fr(s,0,0,!1),e===zr&&(Vt(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),xt(t),t.avail_out===0))return s.last_flush=-1,wt}return e!==zt?wt:s.wrap<=0?cs:(s.wrap===2?(P(s,t.adler&255),P(s,t.adler>>8&255),P(s,t.adler>>16&255),P(s,t.adler>>24&255),P(s,t.total_in&255),P(s,t.total_in>>8&255),P(s,t.total_in>>16&255),P(s,t.total_in>>24&255)):(le(s,t.adler>>>16),le(s,t.adler&65535)),xt(t),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?wt:cs)},uo=t=>{if(!t||!t.state)return bt;let e=t.state.status;return e!==Qe&&e!==xi&&e!==Ne&&e!==Ze&&e!==Le&&e!==Ht&&e!==he?Rt(t,bt):(t.state=null,e===Ht?Rt(t,Mr):wt)},fo=(t,e)=>{let i=e.length;if(!t||!t.state)return bt;let a=t.state,s=a.wrap;if(s===2||s===1&&a.status!==Qe||a.lookahead)return bt;if(s===1&&(t.adler=Se(t.adler,e,i,0)),a.wrap=0,i>=a.w_size){s===0&&(Vt(a.head),a.strstart=0,a.block_start=0,a.insert=0);let b=new Uint8Array(a.w_size);b.set(e.subarray(i-a.w_size,i),0),e=b,i=a.w_size}let n=t.avail_in,r=t.next_in,o=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,Xt(a);a.lookahead>=D;){let b=a.strstart,l=a.lookahead-(D-1);do a.ins_h=Mt(a,a.ins_h,a.window[b+D-1]),a.prev[b&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=b,b++;while(--l);a.strstart=b,a.lookahead=D-1,Xt(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=D-1,a.match_available=0,t.next_in=r,t.input=o,t.avail_in=n,a.wrap=s,wt},_o=co,po=Ra,go=Da,wo=Fa,yo=ho,mo=bo,vo=uo,So=fo,ko=\"pako deflate (from Nodeca project)\",ue={deflateInit:_o,deflateInit2:po,deflateReset:go,deflateResetKeep:wo,deflateSetHeader:yo,deflate:mo,deflateEnd:vo,deflateSetDictionary:So,deflateInfo:ko},Oo=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),Ao=function(t){let e=Array.prototype.slice.call(arguments,1);for(;e.length;){let i=e.shift();if(i){if(typeof i!=\"object\")throw new TypeError(i+\"must be non-object\");for(let a in i)Oo(i,a)&&(t[a]=i[a])}}return t},Io=t=>{let e=0;for(let a=0,s=t.length;a<s;a++)e+=t[a].length;let i=new Uint8Array(e);for(let a=0,s=0,n=t.length;a<n;a++){let r=t[a];i.set(r,s),s+=r.length}return i},Je={assign:Ao,flattenChunks:Io},Pa=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Pa=!1}var ke=new Uint8Array(256);for(let t=0;t<256;t++)ke[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ke[254]=ke[254]=1;var jo=t=>{if(typeof TextEncoder==\"function\"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,i,a,s,n,r=t.length,o=0;for(s=0;s<r;s++)i=t.charCodeAt(s),(i&64512)===55296&&s+1<r&&(a=t.charCodeAt(s+1),(a&64512)===56320&&(i=65536+(i-55296<<10)+(a-56320),s++)),o+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(o),n=0,s=0;n<o;s++)i=t.charCodeAt(s),(i&64512)===55296&&s+1<r&&(a=t.charCodeAt(s+1),(a&64512)===56320&&(i=65536+(i-55296<<10)+(a-56320),s++)),i<128?e[n++]=i:i<2048?(e[n++]=192|i>>>6,e[n++]=128|i&63):i<65536?(e[n++]=224|i>>>12,e[n++]=128|i>>>6&63,e[n++]=128|i&63):(e[n++]=240|i>>>18,e[n++]=128|i>>>12&63,e[n++]=128|i>>>6&63,e[n++]=128|i&63);return e},xo=(t,e)=>{if(e<65534&&t.subarray&&Pa)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i=\"\";for(let a=0;a<e;a++)i+=String.fromCharCode(t[a]);return i},Co=(t,e)=>{let i=e||t.length;if(typeof TextDecoder==\"function\"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let a,s,n=new Array(i*2);for(s=0,a=0;a<i;){let r=t[a++];if(r<128){n[s++]=r;continue}let o=ke[r];if(o>4){n[s++]=65533,a+=o-1;continue}for(r&=o===2?31:o===3?15:7;o>1&&a<i;)r=r<<6|t[a++]&63,o--;if(o>1){n[s++]=65533;continue}r<65536?n[s++]=r:(r-=65536,n[s++]=55296|r>>10&1023,n[s++]=56320|r&1023)}return xo(n,s)},Uo=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let i=e-1;for(;i>=0&&(t[i]&192)===128;)i--;return i<0||i===0?e:i+ke[t[i]]>e?i:e},Oe={string2buf:jo,buf2string:Co,utf8border:Uo};function To(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\"\",this.state=null,this.data_type=2,this.adler=0}var za=To,Ma=Object.prototype.toString,{Z_NO_FLUSH:Vo,Z_SYNC_FLUSH:Fo,Z_FULL_FLUSH:Do,Z_FINISH:Ro,Z_OK:Xe,Z_STREAM_END:Po,Z_DEFAULT_COMPRESSION:zo,Z_DEFAULT_STRATEGY:Mo,Z_DEFLATED:Bo}=ae;function Ce(t){this.options=Je.assign({level:zo,method:Bo,chunkSize:16384,windowBits:15,memLevel:8,strategy:Mo},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg=\"\",this.ended=!1,this.chunks=[],this.strm=new za,this.strm.avail_out=0;let i=ue.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==Xe)throw new Error(Yt[i]);if(e.header&&ue.deflateSetHeader(this.strm,e.header),e.dictionary){let a;if(typeof e.dictionary==\"string\"?a=Oe.string2buf(e.dictionary):Ma.call(e.dictionary)===\"[object ArrayBuffer]\"?a=new Uint8Array(e.dictionary):a=e.dictionary,i=ue.deflateSetDictionary(this.strm,a),i!==Xe)throw new Error(Yt[i]);this._dict_set=!0}}Ce.prototype.push=function(t,e){let i=this.strm,a=this.options.chunkSize,s,n;if(this.ended)return!1;for(e===~~e?n=e:n=e===!0?Ro:Vo,typeof t==\"string\"?i.input=Oe.string2buf(t):Ma.call(t)===\"[object ArrayBuffer]\"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){if(i.avail_out===0&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),(n===Fo||n===Do)&&i.avail_out<=6){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(s=ue.deflate(i,n),s===Po)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),s=ue.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Xe;if(i.avail_out===0){this.onData(i.output);continue}if(n>0&&i.next_out>0){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(i.avail_in===0)break}return!0};Ce.prototype.onData=function(t){this.chunks.push(t)};Ce.prototype.onEnd=function(t){t===Xe&&(this.result=Je.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Ei(t,e){let i=new Ce(e);if(i.push(t,!0),i.err)throw i.msg||Yt[i.err];return i.result}function Eo(t,e){return e=e||{},e.raw=!0,Ei(t,e)}function No(t,e){return e=e||{},e.gzip=!0,Ei(t,e)}var Zo=Ce,Lo=Ei,Ho=Eo,Yo=No,Go=ae,Xo={Deflate:Zo,deflate:Lo,deflateRaw:Ho,gzip:Yo,constants:Go},Re=30,Wo=12,Ko=function(t,e){let i,a,s,n,r,o,b,l,h,O,w,_,V,U,x,I,k,m,A,Z,F,u,S,p,g=t.state;i=t.next_in,S=t.input,a=i+(t.avail_in-5),s=t.next_out,p=t.output,n=s-(e-t.avail_out),r=s+(t.avail_out-257),o=g.dmax,b=g.wsize,l=g.whave,h=g.wnext,O=g.window,w=g.hold,_=g.bits,V=g.lencode,U=g.distcode,x=(1<<g.lenbits)-1,I=(1<<g.distbits)-1;t:do{_<15&&(w+=S[i++]<<_,_+=8,w+=S[i++]<<_,_+=8),k=V[w&x];e:for(;;){if(m=k>>>24,w>>>=m,_-=m,m=k>>>16&255,m===0)p[s++]=k&65535;else if(m&16){A=k&65535,m&=15,m&&(_<m&&(w+=S[i++]<<_,_+=8),A+=w&(1<<m)-1,w>>>=m,_-=m),_<15&&(w+=S[i++]<<_,_+=8,w+=S[i++]<<_,_+=8),k=U[w&I];i:for(;;){if(m=k>>>24,w>>>=m,_-=m,m=k>>>16&255,m&16){if(Z=k&65535,m&=15,_<m&&(w+=S[i++]<<_,_+=8,_<m&&(w+=S[i++]<<_,_+=8)),Z+=w&(1<<m)-1,Z>o){t.msg=\"invalid distance too far back\",g.mode=Re;break t}if(w>>>=m,_-=m,m=s-n,Z>m){if(m=Z-m,m>l&&g.sane){t.msg=\"invalid distance too far back\",g.mode=Re;break t}if(F=0,u=O,h===0){if(F+=b-m,m<A){A-=m;do p[s++]=O[F++];while(--m);F=s-Z,u=p}}else if(h<m){if(F+=b+h-m,m-=h,m<A){A-=m;do p[s++]=O[F++];while(--m);if(F=0,h<A){m=h,A-=m;do p[s++]=O[F++];while(--m);F=s-Z,u=p}}}else if(F+=h-m,m<A){A-=m;do p[s++]=O[F++];while(--m);F=s-Z,u=p}for(;A>2;)p[s++]=u[F++],p[s++]=u[F++],p[s++]=u[F++],A-=3;A&&(p[s++]=u[F++],A>1&&(p[s++]=u[F++]))}else{F=s-Z;do p[s++]=p[F++],p[s++]=p[F++],p[s++]=p[F++],A-=3;while(A>2);A&&(p[s++]=p[F++],A>1&&(p[s++]=p[F++]))}}else if((m&64)===0){k=U[(k&65535)+(w&(1<<m)-1)];continue i}else{t.msg=\"invalid distance code\",g.mode=Re;break t}break}}else if((m&64)===0){k=V[(k&65535)+(w&(1<<m)-1)];continue e}else if(m&32){g.mode=Wo;break t}else{t.msg=\"invalid literal/length code\",g.mode=Re;break t}break}}while(i<a&&s<r);A=_>>3,i-=A,_-=A<<3,w&=(1<<_)-1,t.next_in=i,t.next_out=s,t.avail_in=i<a?5+(a-i):5-(i-a),t.avail_out=s<r?257+(r-s):257-(s-r),g.hold=w,g.bits=_},Qt=15,us=852,fs=592,_s=0,di=1,ps=2,qo=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),$o=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Qo=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Jo=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),tl=(t,e,i,a,s,n,r,o)=>{let b=o.bits,l=0,h=0,O=0,w=0,_=0,V=0,U=0,x=0,I=0,k=0,m,A,Z,F,u,S=null,p=0,g,y=new Uint16Array(Qt+1),R=new Uint16Array(Qt+1),T=null,C=0,L,E,at;for(l=0;l<=Qt;l++)y[l]=0;for(h=0;h<a;h++)y[e[i+h]]++;for(_=b,w=Qt;w>=1&&y[w]===0;w--);if(_>w&&(_=w),w===0)return s[n++]=1<<24|64<<16|0,s[n++]=1<<24|64<<16|0,o.bits=1,0;for(O=1;O<w&&y[O]===0;O++);for(_<O&&(_=O),x=1,l=1;l<=Qt;l++)if(x<<=1,x-=y[l],x<0)return-1;if(x>0&&(t===_s||w!==1))return-1;for(R[1]=0,l=1;l<Qt;l++)R[l+1]=R[l]+y[l];for(h=0;h<a;h++)e[i+h]!==0&&(r[R[e[i+h]]++]=h);if(t===_s?(S=T=r,g=19):t===di?(S=qo,p-=257,T=$o,C-=257,g=256):(S=Qo,T=Jo,g=-1),k=0,h=0,l=O,u=n,V=_,U=0,Z=-1,I=1<<_,F=I-1,t===di&&I>us||t===ps&&I>fs)return 1;for(;;){L=l-U,r[h]<g?(E=0,at=r[h]):r[h]>g?(E=T[C+r[h]],at=S[p+r[h]]):(E=32+64,at=0),m=1<<l-U,A=1<<V,O=A;do A-=m,s[u+(k>>U)+A]=L<<24|E<<16|at|0;while(A!==0);for(m=1<<l-1;k&m;)m>>=1;if(m!==0?(k&=m-1,k+=m):k=0,h++,--y[l]===0){if(l===w)break;l=e[i+r[h]]}if(l>_&&(k&F)!==Z){for(U===0&&(U=_),u+=O,V=l-U,x=1<<V;V+U<w&&(x-=y[V+U],!(x<=0));)V++,x<<=1;if(I+=1<<V,t===di&&I>us||t===ps&&I>fs)return 1;Z=k&F,s[Z]=_<<24|V<<16|u-n|0}}return k!==0&&(s[u+k]=l-U<<24|64<<16|0),o.bits=_,0},fe=tl,el=0,Ba=1,Ea=2,{Z_FINISH:gs,Z_BLOCK:il,Z_TREES:Pe,Z_OK:Wt,Z_STREAM_END:sl,Z_NEED_DICT:al,Z_STREAM_ERROR:ft,Z_DATA_ERROR:Na,Z_MEM_ERROR:Za,Z_BUF_ERROR:nl,Z_DEFLATED:ws}=ae,La=1,ys=2,ms=3,vs=4,Ss=5,ks=6,Os=7,As=8,Is=9,js=10,We=11,yt=12,ci=13,xs=14,bi=15,Cs=16,Us=17,Ts=18,Vs=19,ze=20,Me=21,Fs=22,Ds=23,Rs=24,Ps=25,zs=26,ui=27,Ms=28,Bs=29,N=30,Ha=31,rl=32,ol=852,ll=592,hl=15,dl=hl,Es=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function cl(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Ya=t=>{if(!t||!t.state)return ft;let e=t.state;return t.total_in=t.total_out=e.total=0,t.msg=\"\",e.wrap&&(t.adler=e.wrap&1),e.mode=La,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(ol),e.distcode=e.distdyn=new Int32Array(ll),e.sane=1,e.back=-1,Wt},Ga=t=>{if(!t||!t.state)return ft;let e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Ya(t)},Xa=(t,e)=>{let i;if(!t||!t.state)return ft;let a=t.state;return e<0?(i=0,e=-e):(i=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?ft:(a.window!==null&&a.wbits!==e&&(a.window=null),a.wrap=i,a.wbits=e,Ga(t))},Wa=(t,e)=>{if(!t)return ft;let i=new cl;t.state=i,i.window=null;let a=Xa(t,e);return a!==Wt&&(t.state=null),a},bl=t=>Wa(t,dl),Ns=!0,fi,_i,ul=t=>{if(Ns){fi=new Int32Array(512),_i=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(fe(Ba,t.lens,0,288,fi,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;fe(Ea,t.lens,0,32,_i,0,t.work,{bits:5}),Ns=!1}t.lencode=fi,t.lenbits=9,t.distcode=_i,t.distbits=5},Ka=(t,e,i,a)=>{let s,n=t.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),a>=n.wsize?(n.window.set(e.subarray(i-n.wsize,i),0),n.wnext=0,n.whave=n.wsize):(s=n.wsize-n.wnext,s>a&&(s=a),n.window.set(e.subarray(i-a,i-a+s),n.wnext),a-=s,a?(n.window.set(e.subarray(i-a,i),0),n.wnext=a,n.whave=n.wsize):(n.wnext+=s,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=s))),0},fl=(t,e)=>{let i,a,s,n,r,o,b,l,h,O,w,_,V,U,x=0,I,k,m,A,Z,F,u,S,p=new Uint8Array(4),g,y,R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return ft;i=t.state,i.mode===yt&&(i.mode=ci),r=t.next_out,s=t.output,b=t.avail_out,n=t.next_in,a=t.input,o=t.avail_in,l=i.hold,h=i.bits,O=o,w=b,S=Wt;t:for(;;)switch(i.mode){case La:if(i.wrap===0){i.mode=ci;break}for(;h<16;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if(i.wrap&2&&l===35615){i.check=0,p[0]=l&255,p[1]=l>>>8&255,i.check=$(i.check,p,2,0),l=0,h=0,i.mode=ys;break}if(i.flags=0,i.head&&(i.head.done=!1),!(i.wrap&1)||(((l&255)<<8)+(l>>8))%31){t.msg=\"incorrect header check\",i.mode=N;break}if((l&15)!==ws){t.msg=\"unknown compression method\",i.mode=N;break}if(l>>>=4,h-=4,u=(l&15)+8,i.wbits===0)i.wbits=u;else if(u>i.wbits){t.msg=\"invalid window size\",i.mode=N;break}i.dmax=1<<i.wbits,t.adler=i.check=1,i.mode=l&512?js:yt,l=0,h=0;break;case ys:for(;h<16;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if(i.flags=l,(i.flags&255)!==ws){t.msg=\"unknown compression method\",i.mode=N;break}if(i.flags&57344){t.msg=\"unknown header flags set\",i.mode=N;break}i.head&&(i.head.text=l>>8&1),i.flags&512&&(p[0]=l&255,p[1]=l>>>8&255,i.check=$(i.check,p,2,0)),l=0,h=0,i.mode=ms;case ms:for(;h<32;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}i.head&&(i.head.time=l),i.flags&512&&(p[0]=l&255,p[1]=l>>>8&255,p[2]=l>>>16&255,p[3]=l>>>24&255,i.check=$(i.check,p,4,0)),l=0,h=0,i.mode=vs;case vs:for(;h<16;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}i.head&&(i.head.xflags=l&255,i.head.os=l>>8),i.flags&512&&(p[0]=l&255,p[1]=l>>>8&255,i.check=$(i.check,p,2,0)),l=0,h=0,i.mode=Ss;case Ss:if(i.flags&1024){for(;h<16;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}i.length=l,i.head&&(i.head.extra_len=l),i.flags&512&&(p[0]=l&255,p[1]=l>>>8&255,i.check=$(i.check,p,2,0)),l=0,h=0}else i.head&&(i.head.extra=null);i.mode=ks;case ks:if(i.flags&1024&&(_=i.length,_>o&&(_=o),_&&(i.head&&(u=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(a.subarray(n,n+_),u)),i.flags&512&&(i.check=$(i.check,a,_,n)),o-=_,n+=_,i.length-=_),i.length))break t;i.length=0,i.mode=Os;case Os:if(i.flags&2048){if(o===0)break t;_=0;do u=a[n+_++],i.head&&u&&i.length<65536&&(i.head.name+=String.fromCharCode(u));while(u&&_<o);if(i.flags&512&&(i.check=$(i.check,a,_,n)),o-=_,n+=_,u)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=As;case As:if(i.flags&4096){if(o===0)break t;_=0;do u=a[n+_++],i.head&&u&&i.length<65536&&(i.head.comment+=String.fromCharCode(u));while(u&&_<o);if(i.flags&512&&(i.check=$(i.check,a,_,n)),o-=_,n+=_,u)break t}else i.head&&(i.head.comment=null);i.mode=Is;case Is:if(i.flags&512){for(;h<16;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if(l!==(i.check&65535)){t.msg=\"header crc mismatch\",i.mode=N;break}l=0,h=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=yt;break;case js:for(;h<32;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}t.adler=i.check=Es(l),l=0,h=0,i.mode=We;case We:if(i.havedict===0)return t.next_out=r,t.avail_out=b,t.next_in=n,t.avail_in=o,i.hold=l,i.bits=h,al;t.adler=i.check=1,i.mode=yt;case yt:if(e===il||e===Pe)break t;case ci:if(i.last){l>>>=h&7,h-=h&7,i.mode=ui;break}for(;h<3;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}switch(i.last=l&1,l>>>=1,h-=1,l&3){case 0:i.mode=xs;break;case 1:if(ul(i),i.mode=ze,e===Pe){l>>>=2,h-=2;break t}break;case 2:i.mode=Us;break;case 3:t.msg=\"invalid block type\",i.mode=N}l>>>=2,h-=2;break;case xs:for(l>>>=h&7,h-=h&7;h<32;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if((l&65535)!==(l>>>16^65535)){t.msg=\"invalid stored block lengths\",i.mode=N;break}if(i.length=l&65535,l=0,h=0,i.mode=bi,e===Pe)break t;case bi:i.mode=Cs;case Cs:if(_=i.length,_){if(_>o&&(_=o),_>b&&(_=b),_===0)break t;s.set(a.subarray(n,n+_),r),o-=_,n+=_,b-=_,r+=_,i.length-=_;break}i.mode=yt;break;case Us:for(;h<14;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if(i.nlen=(l&31)+257,l>>>=5,h-=5,i.ndist=(l&31)+1,l>>>=5,h-=5,i.ncode=(l&15)+4,l>>>=4,h-=4,i.nlen>286||i.ndist>30){t.msg=\"too many length or distance symbols\",i.mode=N;break}i.have=0,i.mode=Ts;case Ts:for(;i.have<i.ncode;){for(;h<3;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}i.lens[R[i.have++]]=l&7,l>>>=3,h-=3}for(;i.have<19;)i.lens[R[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,g={bits:i.lenbits},S=fe(el,i.lens,0,19,i.lencode,0,i.work,g),i.lenbits=g.bits,S){t.msg=\"invalid code lengths set\",i.mode=N;break}i.have=0,i.mode=Vs;case Vs:for(;i.have<i.nlen+i.ndist;){for(;x=i.lencode[l&(1<<i.lenbits)-1],I=x>>>24,k=x>>>16&255,m=x&65535,!(I<=h);){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if(m<16)l>>>=I,h-=I,i.lens[i.have++]=m;else{if(m===16){for(y=I+2;h<y;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if(l>>>=I,h-=I,i.have===0){t.msg=\"invalid bit length repeat\",i.mode=N;break}u=i.lens[i.have-1],_=3+(l&3),l>>>=2,h-=2}else if(m===17){for(y=I+3;h<y;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}l>>>=I,h-=I,u=0,_=3+(l&7),l>>>=3,h-=3}else{for(y=I+7;h<y;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}l>>>=I,h-=I,u=0,_=11+(l&127),l>>>=7,h-=7}if(i.have+_>i.nlen+i.ndist){t.msg=\"invalid bit length repeat\",i.mode=N;break}for(;_--;)i.lens[i.have++]=u}}if(i.mode===N)break;if(i.lens[256]===0){t.msg=\"invalid code -- missing end-of-block\",i.mode=N;break}if(i.lenbits=9,g={bits:i.lenbits},S=fe(Ba,i.lens,0,i.nlen,i.lencode,0,i.work,g),i.lenbits=g.bits,S){t.msg=\"invalid literal/lengths set\",i.mode=N;break}if(i.distbits=6,i.distcode=i.distdyn,g={bits:i.distbits},S=fe(Ea,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,g),i.distbits=g.bits,S){t.msg=\"invalid distances set\",i.mode=N;break}if(i.mode=ze,e===Pe)break t;case ze:i.mode=Me;case Me:if(o>=6&&b>=258){t.next_out=r,t.avail_out=b,t.next_in=n,t.avail_in=o,i.hold=l,i.bits=h,Ko(t,w),r=t.next_out,s=t.output,b=t.avail_out,n=t.next_in,a=t.input,o=t.avail_in,l=i.hold,h=i.bits,i.mode===yt&&(i.back=-1);break}for(i.back=0;x=i.lencode[l&(1<<i.lenbits)-1],I=x>>>24,k=x>>>16&255,m=x&65535,!(I<=h);){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if(k&&(k&240)===0){for(A=I,Z=k,F=m;x=i.lencode[F+((l&(1<<A+Z)-1)>>A)],I=x>>>24,k=x>>>16&255,m=x&65535,!(A+I<=h);){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}l>>>=A,h-=A,i.back+=A}if(l>>>=I,h-=I,i.back+=I,i.length=m,k===0){i.mode=zs;break}if(k&32){i.back=-1,i.mode=yt;break}if(k&64){t.msg=\"invalid literal/length code\",i.mode=N;break}i.extra=k&15,i.mode=Fs;case Fs:if(i.extra){for(y=i.extra;h<y;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}i.length+=l&(1<<i.extra)-1,l>>>=i.extra,h-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=Ds;case Ds:for(;x=i.distcode[l&(1<<i.distbits)-1],I=x>>>24,k=x>>>16&255,m=x&65535,!(I<=h);){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if((k&240)===0){for(A=I,Z=k,F=m;x=i.distcode[F+((l&(1<<A+Z)-1)>>A)],I=x>>>24,k=x>>>16&255,m=x&65535,!(A+I<=h);){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}l>>>=A,h-=A,i.back+=A}if(l>>>=I,h-=I,i.back+=I,k&64){t.msg=\"invalid distance code\",i.mode=N;break}i.offset=m,i.extra=k&15,i.mode=Rs;case Rs:if(i.extra){for(y=i.extra;h<y;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}i.offset+=l&(1<<i.extra)-1,l>>>=i.extra,h-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg=\"invalid distance too far back\",i.mode=N;break}i.mode=Ps;case Ps:if(b===0)break t;if(_=w-b,i.offset>_){if(_=i.offset-_,_>i.whave&&i.sane){t.msg=\"invalid distance too far back\",i.mode=N;break}_>i.wnext?(_-=i.wnext,V=i.wsize-_):V=i.wnext-_,_>i.length&&(_=i.length),U=i.window}else U=s,V=r-i.offset,_=i.length;_>b&&(_=b),b-=_,i.length-=_;do s[r++]=U[V++];while(--_);i.length===0&&(i.mode=Me);break;case zs:if(b===0)break t;s[r++]=i.length,b--,i.mode=Me;break;case ui:if(i.wrap){for(;h<32;){if(o===0)break t;o--,l|=a[n++]<<h,h+=8}if(w-=b,t.total_out+=w,i.total+=w,w&&(t.adler=i.check=i.flags?$(i.check,s,w,r-w):Se(i.check,s,w,r-w)),w=b,(i.flags?l:Es(l))!==i.check){t.msg=\"incorrect data check\",i.mode=N;break}l=0,h=0}i.mode=Ms;case Ms:if(i.wrap&&i.flags){for(;h<32;){if(o===0)break t;o--,l+=a[n++]<<h,h+=8}if(l!==(i.total&4294967295)){t.msg=\"incorrect length check\",i.mode=N;break}l=0,h=0}i.mode=Bs;case Bs:S=sl;break t;case N:S=Na;break t;case Ha:return Za;case rl:default:return ft}return t.next_out=r,t.avail_out=b,t.next_in=n,t.avail_in=o,i.hold=l,i.bits=h,(i.wsize||w!==t.avail_out&&i.mode<N&&(i.mode<ui||e!==gs))&&Ka(t,t.output,t.next_out,w-t.avail_out),O-=t.avail_in,w-=t.avail_out,t.total_in+=O,t.total_out+=w,i.total+=w,i.wrap&&w&&(t.adler=i.check=i.flags?$(i.check,s,w,t.next_out-w):Se(i.check,s,w,t.next_out-w)),t.data_type=i.bits+(i.last?64:0)+(i.mode===yt?128:0)+(i.mode===ze||i.mode===bi?256:0),(O===0&&w===0||e===gs)&&S===Wt&&(S=nl),S},_l=t=>{if(!t||!t.state)return ft;let e=t.state;return e.window&&(e.window=null),t.state=null,Wt},pl=(t,e)=>{if(!t||!t.state)return ft;let i=t.state;return(i.wrap&2)===0?ft:(i.head=e,e.done=!1,Wt)},gl=(t,e)=>{let i=e.length,a,s,n;return!t||!t.state||(a=t.state,a.wrap!==0&&a.mode!==We)?ft:a.mode===We&&(s=1,s=Se(s,e,i,0),s!==a.check)?Na:(n=Ka(t,e,i,i),n?(a.mode=Ha,Za):(a.havedict=1,Wt))},wl=Ga,yl=Xa,ml=Ya,vl=bl,Sl=Wa,kl=fl,Ol=_l,Al=pl,Il=gl,jl=\"pako inflate (from Nodeca project)\",kt={inflateReset:wl,inflateReset2:yl,inflateResetKeep:ml,inflateInit:vl,inflateInit2:Sl,inflate:kl,inflateEnd:Ol,inflateGetHeader:Al,inflateSetDictionary:Il,inflateInfo:jl};function xl(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=\"\",this.comment=\"\",this.hcrc=0,this.done=!1}var Cl=xl,qa=Object.prototype.toString,{Z_NO_FLUSH:Ul,Z_FINISH:Tl,Z_OK:Ae,Z_STREAM_END:pi,Z_NEED_DICT:gi,Z_STREAM_ERROR:Vl,Z_DATA_ERROR:Zs,Z_MEM_ERROR:Fl}=ae;function Ue(t){this.options=Je.assign({chunkSize:1024*64,windowBits:15,to:\"\"},t||{});let e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg=\"\",this.ended=!1,this.chunks=[],this.strm=new za,this.strm.avail_out=0;let i=kt.inflateInit2(this.strm,e.windowBits);if(i!==Ae)throw new Error(Yt[i]);if(this.header=new Cl,kt.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary==\"string\"?e.dictionary=Oe.string2buf(e.dictionary):qa.call(e.dictionary)===\"[object ArrayBuffer]\"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=kt.inflateSetDictionary(this.strm,e.dictionary),i!==Ae)))throw new Error(Yt[i])}Ue.prototype.push=function(t,e){let i=this.strm,a=this.options.chunkSize,s=this.options.dictionary,n,r,o;if(this.ended)return!1;for(e===~~e?r=e:r=e===!0?Tl:Ul,qa.call(t)===\"[object ArrayBuffer]\"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),n=kt.inflate(i,r),n===gi&&s&&(n=kt.inflateSetDictionary(i,s),n===Ae?n=kt.inflate(i,r):n===Zs&&(n=gi));i.avail_in>0&&n===pi&&i.state.wrap>0&&t[i.next_in]!==0;)kt.inflateReset(i),n=kt.inflate(i,r);switch(n){case Vl:case Zs:case gi:case Fl:return this.onEnd(n),this.ended=!0,!1}if(o=i.avail_out,i.next_out&&(i.avail_out===0||n===pi))if(this.options.to===\"string\"){let b=Oe.utf8border(i.output,i.next_out),l=i.next_out-b,h=Oe.buf2string(i.output,b);i.next_out=l,i.avail_out=a-l,l&&i.output.set(i.output.subarray(b,b+l),0),this.onData(h)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(!(n===Ae&&o===0)){if(n===pi)return n=kt.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(i.avail_in===0)break}}return!0};Ue.prototype.onData=function(t){this.chunks.push(t)};Ue.prototype.onEnd=function(t){t===Ae&&(this.options.to===\"string\"?this.result=this.chunks.join(\"\"):this.result=Je.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Ni(t,e){let i=new Ue(e);if(i.push(t),i.err)throw i.msg||Yt[i.err];return i.result}function Dl(t,e){return e=e||{},e.raw=!0,Ni(t,e)}var Rl=Ue,Pl=Ni,zl=Dl,Ml=Ni,Bl=ae,El={Inflate:Rl,inflate:Pl,inflateRaw:zl,ungzip:Ml,constants:Bl},{Deflate:Kl,deflate:ql,deflateRaw:Nl,gzip:$l}=Xo,{Inflate:Ql,inflate:Jl,inflateRaw:Zl,ungzip:th}=El,Ll=Nl,Hl=Zl,$a=t=>Hl(t),Ci=t=>Ll(t,{level:9}),Yl=class{constructor(){this.pendingMessages=[]}sendClientMessage(t,e){t.finish(e),this.doSendMessage(Ci(t.asUint8Array()))}getPendingMessages(){return this.pendingMessages}markPendingMessagesAsRead(){this.pendingMessages.length=0}onMessage(t){this.pendingMessages.push(ct.getRootAsServerMessage(new jt($a(t))))}onDisconnection(){ce(\"disconnected\")}},Gl=class{constructor(){this.usersPendingMessages=new Map,this.disconnectedUsers=[]}sendServerMessageTo(t,e,i){e.finish(i),this.doSendMessageTo(t,Ci(e.asUint8Array()))}sendServerMessageToAll(t,e){t.finish(e);let i=Ci(t.asUint8Array());for(let a of this.usersPendingMessages.keys())this.doSendMessageTo(a,i)}getUsersPendingMessages(){return this.usersPendingMessages.entries()}getConnectedUsers(){return this.usersPendingMessages.keys()}getDisconnectedUsers(){return this.disconnectedUsers}onMessage(t,e){this.usersPendingMessages.get(t).push(vt.getRootAsClientMessage(new jt($a(e))))}onConnection(t){this.usersPendingMessages.set(t,[])}onDisconnection(t){this.usersPendingMessages.delete(t),this.disconnectedUsers.push(t)}};gdjs.BBTextRuntimeObject&&(gdjs.BBTextRuntimeObject.prototype.getString=gdjs.BBTextRuntimeObject.prototype.getBBText,gdjs.BBTextRuntimeObject.prototype.setString=gdjs.BBTextRuntimeObject.prototype.setBBText),gdjs.BitmapTextRuntimeObject&&(gdjs.BitmapTextRuntimeObject.prototype.getString=gdjs.BitmapTextRuntimeObject.prototype.getText,gdjs.BitmapTextRuntimeObject.prototype.setString=gdjs.BitmapTextRuntimeObject.prototype.setText,gdjs.BitmapTextRuntimeObject.prototype.getColor=gdjs.BitmapTextRuntimeObject.prototype.getTint,gdjs.BitmapTextRuntimeObject.prototype.setColor=gdjs.BitmapTextRuntimeObject.prototype.setTint);return an(Xl);})();",
            "/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */",
            "{"
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "fullName": "",
      "functionType": "Action",
      "name": "___Lifetime_Functions___",
      "private": true,
      "sentence": "",
      "events": [],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Triggered once when the dedicated server starts up. Returns false if the initialisation is not successful, and crashes the server. Don't forget to log a message in the console before returning false to see why your server crashes!",
      "fullName": "The dedicated server starts",
      "functionType": "Condition",
      "group": "Lifetime function",
      "name": "OnServerStart",
      "private": true,
      "sentence": "The dedicated server starts",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Comment",
          "color": {
            "b": 109,
            "g": 230,
            "r": 255,
            "textB": 0,
            "textG": 0,
            "textR": 0
          },
          "comment": "By default, no special action is done here, and true is returned for signaling a successful initialisation.\nReturn false instead of true to crash the server at the beginnign if something is wrong.\nYou could use this for:\n- Starting all the remote scenes you need, for example, in the case of an MMO, where you want the players to have one remote scene for each \"room\"/scene.\n- Running basic diagnostics like verifying accesses to required external services, for example firebase.\n- Send yourself some analytics to see how many users start their own dedicated server.\n- Prevent running the server on a system that doesn't meet certain requirements.\n- Logging a welcome message when starting up the server :D",
          "comment2": ""
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": [
            {
              "type": {
                "value": "DebuggerTools::ConsoleLog"
              },
              "parameters": [
                "\"Startup succeeded 👍\"",
                "\"info\"",
                "\"Dedicated server\""
              ]
            },
            {
              "type": {
                "value": "SetReturnBoolean"
              },
              "parameters": [
                "True"
              ]
            }
          ]
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Triggers when a client just joined the dedicated server.",
      "fullName": "A client has connected to the server",
      "functionType": "Condition",
      "group": "Lifetime function",
      "name": "OnConnection",
      "private": true,
      "sentence": "A client joined",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Comment",
          "color": {
            "b": 109,
            "g": 230,
            "r": 255,
            "textB": 0,
            "textG": 0,
            "textR": 0
          },
          "comment": "By default, do nothing. Return false to prevent the connection.\nYou can use this to:\n- Update presence informations on your database\n- Prevent unauthenticated players from joining\n- Only let certain beta testers connect to the server at all",
          "comment2": ""
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": [
            {
              "type": {
                "value": "SetReturnBoolean"
              },
              "parameters": [
                "True"
              ]
            }
          ]
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Triggered whenever a client asks for a remote scene to be created. Return false if the creation of the room was not allowed, to tell the client. Remove the \"start a remote scene\" action to disable creating new rooms alltogether.",
      "fullName": "A client requests a remote scene to be created",
      "functionType": "Condition",
      "group": "Lifetime function",
      "name": "OnRSCreationRequest",
      "private": true,
      "sentence": "A client request a remote scene to be created",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Comment",
          "color": {
            "b": 109,
            "g": 230,
            "r": 255,
            "textB": 0,
            "textG": 0,
            "textR": 0
          },
          "comment": "By default, allow all remote scene creations and do as the client says.\nYou can use this: \n- To prevent making other remote scenes out of a scene (for example in an MMORPG where all rooms are in common, people cannot make their own private version of a room).\n- To prevent users that do not have the required privilieges to create certain types of rooms.",
          "comment2": ""
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "inverted": true,
                "value": "THNK::RemoteSceneExists"
              },
              "parameters": [
                "",
                "GetArgumentAsString(\"remote_scene_name\")",
                ""
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "THNK::CreateRemoteScene"
              },
              "parameters": [
                "",
                "GetArgumentAsString(\"base_scene_name\")",
                "GetArgumentAsString(\"remote_scene_name\")",
                ""
              ]
            },
            {
              "type": {
                "value": "DebuggerTools::ConsoleLog"
              },
              "parameters": [
                "\"Remote scene '\" + GetArgumentAsString(\"remote_scene_name\") + \"' based on scene '\" + GetArgumentAsString(\"base_scene_name\") + \"' created\"",
                "\"info\"",
                "\"Dedicated server\""
              ]
            },
            {
              "type": {
                "value": "SetReturnBoolean"
              },
              "parameters": [
                "True"
              ]
            }
          ]
        }
      ],
      "parameters": [
        {
          "description": "The remote scene name",
          "name": "remote_scene_name",
          "type": "string"
        },
        {
          "description": "The name of the scene the remote scene should be based on",
          "name": "base_scene_name",
          "type": "sceneName"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Triggered whenever a client asks to connect to a remote scene. Return false if the creation of the room was not allowed, to tell the client. Remove the \"start a remote scene\" action to disable creating new rooms alltogether.",
      "fullName": "A client requests to join a remote scene",
      "functionType": "Condition",
      "group": "Lifetime function",
      "name": "OnRSJoinRequest",
      "private": true,
      "sentence": "A client request to join a remote scene",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Comment",
          "color": {
            "b": 109,
            "g": 230,
            "r": 255,
            "textB": 0,
            "textG": 0,
            "textR": 0
          },
          "comment": "By default, allow joining all rooms.\nYou can use this: \n- To make a set of remote scenes only available to beta testers.\n- To prevent joining any remote scenes without an approved account.\n- To lock a banned player out of joining remote scenes.",
          "comment2": ""
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "THNK::RemoteSceneExists"
              },
              "parameters": [
                "",
                "GetArgumentAsString(\"remote_scene_name\")",
                ""
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "THNK::MoveToRemoteScene"
              },
              "parameters": [
                "",
                "GetArgumentAsString(\"remote_scene_name\")",
                ""
              ]
            },
            {
              "type": {
                "value": "DebuggerTools::ConsoleLog"
              },
              "parameters": [
                "\"Player '\" + ToString(THNK::PickedPlayer()) + \"' joined remote scene '\" + GetArgumentAsString(\"base_scene_name\") + \"'\"",
                "\"info\"",
                "\"Dedicated server\""
              ]
            },
            {
              "type": {
                "value": "SetReturnBoolean"
              },
              "parameters": [
                "True"
              ]
            }
          ]
        }
      ],
      "parameters": [
        {
          "description": "The remote scene name",
          "name": "remote_scene_name",
          "type": "string"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Triggers when a client just disconnected from the dedicated server.",
      "fullName": "A client has disconnected from the server",
      "functionType": "Condition",
      "group": "Lifetime function",
      "name": "OnDisconnection",
      "private": true,
      "sentence": "A client disconnected",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Comment",
          "color": {
            "b": 109,
            "g": 230,
            "r": 255,
            "textB": 0,
            "textG": 0,
            "textR": 0
          },
          "comment": "By default, do nothing.\nYou can use this to:\n- Update presence informations on your database\n- Apply sanctions to a player if they disconnected at a moment they were not allowed to",
          "comment2": ""
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": [
            {
              "type": {
                "value": "SetReturnBoolean"
              },
              "parameters": [
                "True"
              ]
            }
          ]
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "fullName": "",
      "functionType": "Action",
      "name": "___Client___",
      "private": true,
      "sentence": "",
      "events": [],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Checks if the game is currently running a server. Do not use this to delimit server code, as this ignores the server tick rate. Rather, use this in client code to display additional options reseerved to the host",
      "fullName": "Is a server?",
      "functionType": "Condition",
      "group": "Client",
      "name": "IsServer",
      "sentence": "A server is running on this client",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "eventsFunctionContext.returnValue = !!runtimeScene.thnkServer;",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Triggers if the current scene is in singleplayer mode. When switching to a scene normally (without connecting to a remote scene), the game runs in this mode and doesn't run any netcode, while still emulating the THNK framework to allow the game to run as it would otherwise. This condition can be used to disable features that only make sense in multiplayer, like a chat, in the case the game is not being played in multiplayer.",
      "fullName": "Is singleplayer?",
      "functionType": "Condition",
      "name": "IsSinglePlayer",
      "sentence": "Scene running in singleplayer mode",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "// If we are neither client nor server, we are playing singleplayer.",
            "eventsFunctionContext.returnValue = !runtimeScene.thnkServer && !runtimeScene.thnkClient;",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "The condition to put before the start of client code. This ensures that dedicated servers do not run client-only code.",
      "fullName": "Start client code",
      "functionType": "Condition",
      "group": "Client",
      "name": "StartClientCode",
      "sentence": "Currently running on the client",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "eventsFunctionContext.returnValue = !THNK.settings.DEDICATED;",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Checks if a connection to a server/remote scene is currently in progress",
      "fullName": "Is connecting to the server?",
      "functionType": "Condition",
      "group": "Client",
      "name": "ConnectingToServer",
      "sentence": "Connecting to server",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "eventsFunctionContext.returnValue = THNK.client.getConnectionState() === \"connecting\";",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Checks if the connection to the server has failed. If the connection succeeded, the game would have switched to the remote scene.",
      "fullName": "Connection to server failed",
      "functionType": "Condition",
      "group": "Client",
      "name": "ConnectionFailed",
      "private": true,
      "sentence": "Connection to the server has failed",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Comment",
          "color": {
            "b": 109,
            "g": 230,
            "r": 255,
            "textB": 0,
            "textG": 0,
            "textR": 0
          },
          "comment": "UNIMPLEMENTED",
          "comment2": ""
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Gives the error code returned by the server while attempting a connection",
      "fullName": "Server connection error code",
      "functionType": "StringExpression",
      "group": "Client",
      "name": "ServerConnectionError",
      "private": true,
      "sentence": "",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Comment",
          "color": {
            "b": 109,
            "g": 230,
            "r": 255,
            "textB": 0,
            "textG": 0,
            "textR": 0
          },
          "comment": "UNIMPLEMENTED",
          "comment2": ""
        }
      ],
      "expressionType": {
        "type": "string"
      },
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Sends a message to the server.",
      "fullName": "Send a message to the server",
      "functionType": "Action",
      "group": "Client",
      "name": "SendMessage",
      "sentence": "Send message _PARAM1_ to the server (extra data: _PARAM2_)",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (runtimeScene.thnkClient) {",
            "    THNK.client.messages.sendClientMessage(",
            "        runtimeScene.thnkClient.adapter,",
            "        eventsFunctionContext.getArgument(\"message\"),",
            "        eventsFunctionContext.getArgument(\"extra_data\")",
            "    );",
            "} else THNK.server.events.addRawMessageToTheQueue(",
            "    runtimeScene.thnkServer",
            "        ? runtimeScene.thnkServer.adapter.getServerID()",
            "        : THNK.players.getCurrentPlayerID(),",
            "    eventsFunctionContext.getArgument(\"message\"),",
            "    eventsFunctionContext.getArgument(\"extra_data\")",
            ");",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "The message name",
          "name": "message",
          "type": "string"
        },
        {
          "description": "(Optional) A variable with extra data for the server",
          "name": "extra_data",
          "type": "scenevar"
        }
      ],
      "objectGroups": []
    },
    {
      "fullName": "",
      "functionType": "Action",
      "name": "___Server___",
      "private": true,
      "sentence": "",
      "events": [],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "The condition to put before the start of server code. Ensures that events meant for the server are only run when needed.",
      "fullName": "Start server code",
      "functionType": "Condition",
      "group": "Server",
      "name": "StartServerCode",
      "sentence": "Server code should run",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "eventsFunctionContext.returnValue = runtimeScene.thnkServer ",
            "    // The server is active, only run server code if it is time to.",
            "    ? runtimeScene.thnkServer.runServerCode ",
            "    // The server is innactive. Only run the server code if client mode is innactive too, as that'd mean singleplayer.",
            "    : !runtimeScene.thnkClient;",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Give the server a target of ticks per second. A tick is when the server side code is executed. Default is 20.",
      "fullName": "Set target tick rate",
      "functionType": "Action",
      "group": "Server",
      "name": "SetServerTickRate",
      "sentence": "Set server target TPS to _PARAM1_",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": []
        },
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "THNK.settings.setTickRate(eventsFunctionContext.getArgument(\"TargetTPS\"));",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "The new TPS target",
          "name": "TargetTPS",
          "type": "expression"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Sets the currently picked player to another one, by its ID",
      "fullName": "Pick a player (by ID)",
      "functionType": "Action",
      "group": "Server/Player",
      "name": "PickPlayerByID",
      "sentence": "Set the picked player to _PARAM1_",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "eventsFunctionContext.returnValue =",
            "    THNK.players.switchPlayerContext(eventsFunctionContext.getArgument(\"PlayerID\"));",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "The ID of the picked player",
          "name": "PlayerID",
          "type": "string"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Returns the ID of the player that is currently picked. The picked player can be changed by some conditions (like OnMessage) and actions, and will be used to know who to target with other actions (like MoveToRemoteScene) and conditions. Use THNK::PlayerID() to get your own player ID.",
      "fullName": "Currenty picked player's ID",
      "functionType": "StringExpression",
      "group": "Server/Player",
      "name": "PickedPlayer",
      "sentence": "",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "eventsFunctionContext.returnValue = THNK.players.getCurrentPlayerID();",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "expressionType": {
        "type": "string"
      },
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Links an object to the currently selected player.",
      "fullName": "Link object to the player",
      "functionType": "Action",
      "group": "Server/Player",
      "name": "LinkObjectToPlayer",
      "sentence": "Link _PARAM1_ to the current player",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "for (const obj of objects) THNK.players.markObjectAsOwned(obj);",
            ""
          ],
          "parameterObjects": "Object",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "The object to link to the current player",
          "name": "Object",
          "type": "objectList"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Pick the instances of the object that are linked to the currently picked player.",
      "fullName": "Pick linked objects",
      "functionType": "Condition",
      "group": "Server/Player",
      "name": "UseLinkedObjects",
      "sentence": "Pick instances of _PARAM1_ linked to the player",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "THNK.players.pickOwnedObjects(eventsFunctionContext.getObjectsLists(\"Object\"));",
            "eventsFunctionContext.returnValue = true;",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "The object to pick linked instances for",
          "name": "Object",
          "type": "objectList"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Triggered when a message from the client has been received.",
      "fullName": "Received message from client",
      "functionType": "Condition",
      "group": "Server/Remote Scene Lifetime",
      "name": "OnMessage",
      "sentence": "Client sent message _PARAM1_ (extra data: _PARAM2_)",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (!runtimeScene.thnkClient) eventsFunctionContext.returnValue = THNK.server.events.popMessage(",
            "    eventsFunctionContext.getArgument(\"message\"),",
            "    eventsFunctionContext.getArgument(\"extra_data\")",
            ");",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [
        {
          "description": "The name of the message",
          "name": "message",
          "type": "string"
        },
        {
          "description": "(Optional) A variable with extra data from the client",
          "name": "extra_data",
          "type": "scenevar"
        }
      ],
      "objectGroups": []
    },
    {
      "description": "Triggers when a client has connected to the scene.",
      "fullName": "On client connected",
      "functionType": "Condition",
      "group": "Server/Remote Scene Lifetime",
      "name": "OnClientConnect",
      "sentence": "A client has connected",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Comment",
          "color": {
            "b": 109,
            "g": 230,
            "r": 255,
            "textB": 0,
            "textG": 0,
            "textR": 0
          },
          "comment": "In singleplayer, there is only one player. Trigger their connection event one at the start and that's it.",
          "comment2": ""
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "THNK::IsSinglePlayer"
              },
              "parameters": [
                "",
                ""
              ]
            },
            {
              "type": {
                "value": "DepartScene"
              },
              "parameters": [
                ""
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "SetReturnBoolean"
              },
              "parameters": [
                "True"
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (runtimeScene.thnkServer) eventsFunctionContext.returnValue = THNK.server.events.popConnection(runtimeScene);",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    },
    {
      "description": "Triggers when a client has disconnected from the scene.",
      "fullName": "On client disconnected",
      "functionType": "Condition",
      "group": "Server/Remote Scene Lifetime",
      "name": "OnClientDisconnect",
      "sentence": "A client has disconnected",
      "events": [
        {
          "type": "BuiltinCommonInstructions::JsCode",
          "inlineCode": [
            "if (runtimeScene.thnkServer) eventsFunctionContext.returnValue = THNK.server.events.popDisconnection(runtimeScene);",
            ""
          ],
          "parameterObjects": "",
          "useStrict": true,
          "eventsSheetExpanded": false
        }
      ],
      "parameters": [],
      "objectGroups": []
    }
  ],
  "eventsBasedBehaviors": [
    {
      "description": "Makes the THNK framework automatically synchronize instances of an object across clients. To be used for objects like moving terrain, player objects, etc: objects that will display the same for every user.\nNot to be used on objects unique to a single user, like an inventory menu. Prefer to send over variables the contents of the inventory and display it with non-synchronized objects.",
      "fullName": "Synchronize object",
      "name": "SynchronizedObject",
      "objectType": "",
      "eventsFunctions": [
        {
          "fullName": "",
          "functionType": "Action",
          "name": "doStepPreEvents",
          "sentence": "",
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "ObjectVariableAsBoolean"
                  },
                  "parameters": [
                    "Object",
                    "__THNK.Initialized",
                    ""
                  ]
                }
              ],
              "actions": [
                {
                  "type": {
                    "value": "SetObjectVariableAsBoolean"
                  },
                  "parameters": [
                    "Object",
                    "__THNK.Initialized",
                    "True"
                  ]
                }
              ],
              "events": [
                {
                  "type": "BuiltinCommonInstructions::JsCode",
                  "inlineCode": [
                    "if (runtimeScene.thnkServer)",
                    "    runtimeScene.thnkServer.objectsRegistery.registerObject(objects[0]);",
                    "",
                    "if (runtimeScene.thnkClient && typeof objects[0].thnkID !== \"number\") {",
                    "    // Object was not created by the server but the game is in client mode, delete it.",
                    "    objects[0].deleteFromScene(runtimeScene);",
                    "",
                    "    // Workaround a GDevelop bug that creates a ghost object when deleting an object at the beginning of the scene",
                    "    if (runtimeScene.getTimeManager().isFirstFrame()) {",
                    "        runtimeScene.getAsyncTasksManager().addTask(new gdjs.ResolveTask(), () => {",
                    "            objects[0].onDestroyFromScene(runtimeScene);",
                    "        });",
                    "    }",
                    "}",
                    ""
                  ],
                  "parameterObjects": "Object",
                  "useStrict": true,
                  "eventsSheetExpanded": false
                }
              ]
            }
          ],
          "parameters": [
            {
              "description": "Object",
              "name": "Object",
              "type": "object"
            },
            {
              "description": "Behavior",
              "name": "Behavior",
              "supplementaryInformation": "THNK::SynchronizedObject",
              "type": "behavior"
            }
          ],
          "objectGroups": []
        },
        {
          "fullName": "",
          "functionType": "Action",
          "name": "onDestroy",
          "sentence": "",
          "events": [
            {
              "type": "BuiltinCommonInstructions::JsCode",
              "inlineCode": [
                "if (runtimeScene.thnkServer)",
                "    runtimeScene.thnkServer.objectsRegistery.unregisterObject(objects[0]);",
                ""
              ],
              "parameterObjects": "Object",
              "useStrict": true,
              "eventsSheetExpanded": false
            }
          ],
          "parameters": [
            {
              "description": "Object",
              "name": "Object",
              "type": "object"
            },
            {
              "description": "Behavior",
              "name": "Behavior",
              "supplementaryInformation": "THNK::SynchronizedObject",
              "type": "behavior"
            }
          ],
          "objectGroups": []
        }
      ],
      "propertyDescriptors": [],
      "sharedPropertyDescriptors": []
    }
  ],
  "eventsBasedObjects": []
}